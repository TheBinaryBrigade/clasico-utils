"use strict";var Clasico=(()=>{var Z=Object.defineProperty;var Je=Object.getOwnPropertyDescriptor;var Ze=Object.getOwnPropertyNames,_e=Object.getOwnPropertySymbols;var Be=Object.prototype.hasOwnProperty,Ye=Object.prototype.propertyIsEnumerable;var we=(e,t,n)=>t in e?Z(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,R=(e,t)=>{for(var n in t||(t={}))Be.call(t,n)&&we(e,n,t[n]);if(_e)for(var n of _e(t))Ye.call(t,n)&&we(e,n,t[n]);return e};var ee=(e,t)=>{for(var n in t)Z(e,n,{get:t[n],enumerable:!0})},Ke=(e,t,n,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of Ze(t))!Be.call(e,a)&&a!==n&&Z(e,a,{get:()=>t[a],enumerable:!(s=Je(t,a))||s.enumerable});return e};var Xe=e=>Ke(Z({},"__esModule",{value:!0}),e);var vt={};ee(vt,{default:()=>Ct});var Te={};var fe={};ee(fe,{BisectArray:()=>S,ReverseCompareArray:()=>le,ReverseNumberArray:()=>oe,ReverseSortedArray:()=>D,ReverseStringArray:()=>ue,SortedArray:()=>ie,SortedCompareArray:()=>pe,SortedNumberArray:()=>ae,SortedStringArray:()=>ce});var Le=e=>{let t=e.getDay();return t===0||t===6},Qe=(e,t,n)=>e>=t&&e<=n,He=e=>{try{let t=new Date(e);if(!isNaN(t.getTime()))return t}catch(t){}return null},Y={parse:He,isWeekend:Le,between:Qe};var te=e=>typeof e=="number"||e instanceof Number||typeof e=="bigint"||e instanceof BigInt,I=e=>typeof e=="string"||e instanceof String,ne=e=>typeof e=="boolean"||e instanceof Boolean,se=e=>typeof e=="function"||e instanceof Function,et=e=>U(e)?!1:typeof e=="object",U=e=>e==null,ke=e=>Array.isArray(e)||e instanceof Array||Object.prototype.toString.call(e)==="[object Array]",xe=e=>e instanceof Set||Object.prototype.toString.call(e)==="[object Set]",tt=e=>U(e)?!1:se(e[Symbol.iterator]),nt=e=>te(e)?!0:I(e)?!isNaN(e)&&!isNaN(parseFloat(e)):!1,re=e=>{if(ne(e))return!0;let t=te(e),n=I(e);if(t||n){let s=["true","false",1,0,"1","0",new Boolean(!0),new Boolean(!1),!0,!1];if(s.includes(e))return!0;if(n){e=e.trim();let a=Math.max(...s.map(o=>o.toString().length));if(e.length<=a&&s.includes(e.toLowerCase()))return!0}}return!1},Ne=e=>(e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof BigInt||e instanceof Symbol)&&e.valueOf&&se(e.valueOf)?e.valueOf():e,Se=e=>{let t=Ne(e);if(e===!0||t===!0)return!0;if(re(e)){let n=[!0,"true","1",1,new Boolean(!0)];if(n.includes(e))return!0;if(!U(t)){if(n.includes(t))return!0;I(t)&&(e=t)}if(I(e)){let s=e.trim(),a=Math.max(...n.map(o=>o.toString().length));if(s.length<=a&&n.includes(s.toLowerCase()))return!0}}return!1},st=e=>e===!1||Ne(e)===!1?!0:re(e)?!Se(e):!1,rt=e=>U(e)||I(e)&&typeof e=="string"&&(e=e.trim(),!e)||ne(e)||ke(e)||xe(e)?!1:!!Y.parse(e),it=(e,t=!1)=>U(e)?!1:!!(e instanceof Error||t&&e&&e.stack&&e.message),d={isNil:U,isNumber:te,isString:I,isBoolean:ne,isFunction:se,isObject:et,isNumeric:nt,isValidBoolean:re,isTrue:Se,isFalse:st,isArray:ke,isSet:xe,isIterable:tt,isDate:rt,isError:it};var S=class extends Array{constructor(n){let s=n.items;super(...s);this.opts=n;this.isValidCmp()?this.sort(this.opts.cmp):this.sort((a,o)=>this.opts.key(a)-this.opts.key(o)),this.opts.asReversed&&this.reverse()}pop(){return this.isReversed()?super.pop():super.shift()}push(...n){for(let s of n){let a=this.binarySearch(s);this.splice(a,0,s)}return this.length}binarySearch(n){let s=0,a=this.length-1;for(;s<=a;){let o=Math.floor((s+a)/2);if(this.shouldSwap(this[o],n))s=o+1;else if(this.shouldSwap(n,this[o]))a=o-1;else return o}return s}shouldSwap(n,s){if(this.opts.cmp&&this.isValidCmp())return this.isReversed()?this.opts.cmp(s,n)<=0:this.opts.cmp(n,s)<=0;let a=this.opts.key(n),o=this.opts.key(s);return this.isReversed()?o-a<=0:a-o<=0}isValidCmp(){return this.opts.cmp&&d.isFunction(this.opts.cmp)}isReversed(){return this.opts.asReversed}},D=class extends S{constructor(t,...n){super({key:t,asReversed:!0,items:n})}},ie=class extends S{constructor(t,...n){super({key:t,asReversed:!1,items:n})}},oe=class extends S{constructor(...t){super({key:n=>n,asReversed:!0,items:t})}},ae=class extends S{constructor(...t){super({key:n=>n,asReversed:!1,items:t})}},ue=class extends S{constructor(...t){super({key:()=>0,cmp:(n,s)=>n.localeCompare(s),asReversed:!0,items:t})}},ce=class extends S{constructor(...t){super({key:()=>0,cmp:(n,s)=>n.localeCompare(s),asReversed:!0,items:t})}},le=class extends S{constructor(t,...n){super({key:()=>0,cmp:t,asReversed:!0,items:n})}},pe=class extends S{constructor(t,...n){super({key:()=>0,cmp:t,asReversed:!0,items:n})}};var Re=R({},fe);function Oe(e,t,n){function s(v,p,C){let m=new Map;for(let _=p;_<=C;_++){let y=v[_];m.has(y)?(m.get(y).count++,m.get(y).index=_):m.set(y,{count:1,index:_})}return m.forEach((_,y,$)=>{_.count!==1?$.delete(y):$.set(y,_.index)}),m}function a(v,p,C,m,_,y){let $=s(v,p,C),A=s(m,_,y);return $.forEach((H,W,J)=>{A.has(W)?J.set(W,{indexA:H,indexB:A.get(W)}):J.delete(W)}),$}function o(v){let p=[];v.forEach((m,_,y)=>{let $=0;for(;p[$]&&p[$][p[$].length-1].indexB<m.indexB;)$++;p[$]||(p[$]=[]),0<$&&(m.prev=p[$-1][p[$-1].length-1]),p[$].push(m)});let C=[];if(0<p.length){let m=p.length-1;for(C=[p[m][p[m].length-1]];C[C.length-1].prev;)C.push(C[C.length-1].prev)}return C.reverse()}let i=[],u=0,l=0,h=[],c=[],b=[],B=[];function N(v,p){p<0?(h.push(e[v]),c.push(i.length),u++):v<0&&(b.push(t[p]),B.push(i.length),l++),i.push({line:0<=v?e[v]:t[p],aIndex:v,bIndex:p})}function k(v,p,C,m){for(;v<=p&&C<=m&&e[v]===t[C];)N(v++,C++);let _=p;for(;v<=p&&C<=m&&e[p]===t[m];)p--,m--;let y=a(e,v,p,t,C,m);if(y.size===0){for(;v<=p;)N(v++,-1);for(;C<=m;)N(-1,C++)}else j(v,p,C,m,y);for(;p<_;)N(++p,++m)}function j(v,p,C,m,_){let y=o(_||a(e,v,p,t,C,m));if(y.length===0)k(v,p,C,m);else{(v<y[0].indexA||C<y[0].indexB)&&k(v,y[0].indexA-1,C,y[0].indexB-1);let $;for($=0;$<y.length-1;$++)k(y[$].indexA,y[$+1].indexA-1,y[$].indexB,y[$+1].indexB-1);(y[$].indexA<=p||y[$].indexB<=m)&&k(y[$].indexA,p,y[$].indexB,m)}}return j(0,e.length-1,0,t.length-1),n?{lines:i,lineCountDeleted:u,lineCountInserted:l,lineCountMoved:0,aMove:h,aMoveIndex:c,bMove:b,bMoveIndex:B}:{lines:i,lineCountDeleted:u,lineCountInserted:l,lineCountMoved:0}}var Rt=Oe([],[],!0),ot=(e,t)=>{let n=Oe(e.split(`
`),t.split(`
`),!0);return{changes:n.lines.map((a,o)=>{let i="unknown";return a.aIndex>=0&&a.bIndex<0?i="deleted":a.aIndex<0&&a.bIndex>=0?i="inserted":a.aIndex>=0&&a.bIndex>=0&&(i="changed"),{changeType:i,lineNumber:o+1,lineContent:a.line,aIndex:a.aIndex,bIndex:a.bIndex}}),deletedCount:n.lineCountDeleted,insertedCount:n.lineCountInserted,movedCount:n.lineCountInserted,linedMovedFromA:n.aMove||[],linesMovedFromB:n.bMove||[],_diff:n}},Ae={compare:ot};var he=(e,t,n=2)=>{let s=(b,B)=>{b=" ".repeat(B-1)+b.toLowerCase()+" ".repeat(B-1);let N=new Array(b.length-B+1);for(let k=0;k<N.length;k++)N[k]=b.slice(k,k+B);return N};if(!(e!=null&&e.length)||!(t!=null&&t.length))return 0;let a=e.length<t.length?e:t,o=e.length<t.length?t:e,i=s(a,n),u=s(o,n),l=new Set(i),h=u.length,c=0;for(let b of u)l.delete(b)&&c++;return c/h},at=(e,t,n,s=5,a=.35,o=2)=>{let i=n(e);s<=0&&(s=5);let u=new Map,l=new D(h=>{let c=n(h),b=u.get(c),B=b||he(i,c,o);return b===void 0&&u.set(c,B),B});return t.forEach(h=>{if(he(i,n(h),o)>=a&&(l.push(h),l.length>s)){let b=l.pop();b&&u.delete(n(b))}}),[...l]},K={similarity:he,topSimilar:at};var ut=(e,t=!0)=>{if(t&&!d.isString(e)){if(d.isSet(e)&&(e=Array.from(e)),d.isObject(e))try{e=JSON.stringify(e)}catch(s){let a=[];e=JSON.stringify(e,(i,u)=>{if(typeof u=="object"&&u!==null){if(a.includes(u))return"[Circular]";a.push(u)}return u}).replace(/"\[Circular\]"/g,()=>JSON.stringify("[Circular]"))}!d.isString(e)&&e.toString&&(e=e.toString())}if(!d.isString(e))return null;let n=0;for(let s=0;s<e.length;++s){let a=e.charCodeAt(s);n=(n<<5)-n+a,n&=n}return n},ct=e=>d.isString(e)?e.charAt(0).toUpperCase()+e.slice(1):"",M={hashCode:ut,capitalize:ct};var de=[[/(quiz)$/i,"$1zes"],[/^(oxen)$/i,"$1"],[/^(ox)$/i,"$1en"],[/(m|l)ice$/i,"$1ice"],[/(m|l)ouse$/i,"$1ice"],[/(passer)s?by$/i,"$1sby"],[/(matr|vert|ind)(?:ix|ex)$/i,"$1ices"],[/(x|ch|ss|sh)$/i,"$1es"],[/([^aeiouy]|qu)y$/i,"$1ies"],[/(hive)$/i,"$1s"],[/([lr])f$/i,"$1ves"],[/([^f])fe$/i,"$1ves"],[/sis$/i,"ses"],[/([ti])a$/i,"$1a"],[/([ti])um$/i,"$1a"],[/(buffal|potat|tomat)o$/i,"$1oes"],[/(bu)s$/i,"$1ses"],[/(alias|status)$/i,"$1es"],[/(octop|vir)i$/i,"$1i"],[/(octop|vir)us$/i,"$1i"],[/^(ax|test)is$/i,"$1es"],[/s$/i,"s"],[/$/i,"s"]],me=[[/(database)s$/i,"$1"],[/(quiz)zes$/i,"$1"],[/(matr)ices$/i,"$1ix"],[/(vert|ind)ices$/i,"$1ex"],[/(passer)sby$/i,"$1by"],[/^(ox)en/i,"$1"],[/(alias|status)(es)?$/i,"$1"],[/(octop|vir)(us|i)$/i,"$1us"],[/^(a)x[ie]s$/i,"$1xis"],[/(cris|test)(is|es)$/i,"$1is"],[/(shoe)s$/i,"$1"],[/(o)es$/i,"$1"],[/(bus)(es)?$/i,"$1"],[/(m|l)ice$/i,"$1ouse"],[/(x|ch|ss|sh)es$/i,"$1"],[/(m)ovies$/i,"$1ovie"],[/(s)eries$/i,"$1eries"],[/([^aeiouy]|qu)ies$/i,"$1y"],[/([lr])ves$/i,"$1f"],[/(tive)s$/i,"$1"],[/(hive)s$/i,"$1"],[/([^f])ves$/i,"$1fe"],[/(t)he(sis|ses)$/i,"$1hesis"],[/(s)ynop(sis|ses)$/i,"$1ynopsis"],[/(p)rogno(sis|ses)$/i,"$1rognosis"],[/(p)arenthe(sis|ses)$/i,"$1arenthesis"],[/(d)iagno(sis|ses)$/i,"$1iagnosis"],[/(b)a(sis|ses)$/i,"$1asis"],[/(a)naly(sis|ses)$/i,"$1nalysis"],[/([ti])a$/i,"$1um"],[/(n)ews$/i,"$1ews"],[/(ss)$/i,"$1"],[/s$/i,""]],ge=new Set(["equipment","fish","information","jeans","money","rice","series","sheep","species"]),w=(e,t)=>{let n=i=>Array.from(i).map(u=>"["+u+u.toUpperCase()+"]").join(""),s=(i,u,l)=>{i.splice(u,0,[new RegExp(l[0],"i"),l[1]])},a=(i,u)=>{s(de,i,u)},o=(i,u)=>{s(me,i,u)};e[0].toUpperCase()==t[0].toUpperCase()?(a(0,[`(${e[0]})${e.slice(1)}$`,"$1"+t.slice(1)]),a(0,[`(${t[0]})${t.slice(1)}$`,"$1"+t.slice(1)]),o(0,[`(${t[0]})${t.slice(1)}$`,"$1"+e.slice(1)])):(a(0,[`${e[0].toUpperCase()}${n(e.slice(1))}$`,t[0].toUpperCase()+t.slice(1)]),a(0,[`${e[0].toLowerCase()}${n(e.slice(1))}$`,t[0].toLowerCase()+t.slice(1)]),a(0,[`${t[0].toUpperCase()}${n(t.slice(1))}$`,t[0].toUpperCase()+t.slice(1)]),a(0,[`${t[0].toLowerCase()}${n(t.slice(1))}$`,t[0].toLowerCase()+t.slice(1)]),o(0,[`${t[0].toUpperCase()}${n(t.slice(1))}$`,e[0].toUpperCase()+e.slice(1)]),o(0,[`${t[0].toLowerCase()}${n(t.slice(1))}$`,e[0].toLowerCase()+e.slice(1)]))},lt=(e,t=!0)=>{let n=Fe(e).replace(/-/," ").replace(/(?:^\w|[A-Z]|\b\w)/g,(a,o)=>o===0?a.toLowerCase():a.toUpperCase()).replace(/\s+/g,"");return t?n.charAt(0).toUpperCase()+n.slice(1):n},Fe=e=>e.replace(/_/g,"-"),je=e=>(e=e.replace(/_id$/i,""),e=e.replace(/_/g," "),e=e.replace(/([a-z\d]*)/g,t=>t.toLowerCase()),e=e.replace(/^\w/,t=>t.toUpperCase()),e),We=e=>{let t=Math.abs(parseInt(e));if([11,12,13].includes(t%100))return"th";switch(t%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}},pt=e=>e+We(e),ft=(e,t="-")=>{let s=Ue(e).replace(/[^\d\w-]+/gmi,t);if(t!==""){for(;s.startsWith(t);)s=s.slice(t.length);for(;s.endsWith(t);)s=s.slice(0,s.length-t.length)}return s.toLowerCase()},Ie=e=>{let t=/[A-Z]/.test(e.charAt(0)),n=/[A-Za-z]$/.test(e);if(!e||ge.has(e.toLowerCase())||!n)return e;for(let s of de){let a=s[0],o=s[1];if(a.test(e)){let i=e.replace(a,o);return t?M.capitalize(i):i}}return e},ht=e=>{let t=/[A-Z]/.test(e.charAt(0));for(let n of ge)if(new RegExp(`\\b${n}\\b`,"i").test(e))return e;for(let n of me){let s=n[0],a=n[1];if(s.test(e)){let o=e.replace(s,a);return t?M.capitalize(o):o}}return e},dt=e=>Ie(ye(e)),mt=e=>je(ye(e)).split(/\s+/).map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" "),Ue=e=>e.normalize("NFKD").replace(/[\u0300-\u036f]/g,"").replace(/[^\x00-\x7F]/g,"").trim(),ye=e=>{let t=e.replace(/([a-z\d])([A-Z])/g,"$1_$2");return t=t.replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2"),t=t.replace(/-/g,"_"),t.toLowerCase()};w("person","people");w("man","men");w("human","humans");w("child","children");w("sex","sexes");w("move","moves");w("cow","kine");w("zombie","zombies");w("slave","slaves");w("this","this");w("flour","flour");w("milk","milk");w("water","water");w("reserve","reserves");w("gas","gasses");w("bias","biases");w("atlas","atlases");w("goose","geese");w("pasta","pastas");w("slice","slices");w("cactus","cacti");var V={camelize:lt,dasherize:Fe,humanize:je,ordinal:We,ordinalize:pt,parameterize:ft,pluralize:Ie,singularize:ht,tableize:dt,titleize:mt,transliterate:Ue,underscore:ye,UNCOUNTABLES:ge,PLURALS:de,SINGULARS:me};var q="$B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B",O={0:"PREC0",1:"PREC1",2:"COUNT_PRECS",PREC0:0,PREC1:1,COUNT_PRECS:2};Object.freeze(O);Object.seal(O);var G={"+":{func:(e,t)=>[e,t].every(d.isNumber)?e+t:`${e}+${t}`,prec:O.PREC0},"-":{func:(e,t)=>[e,t].every(d.isNumber)?e-t:`${e}-${t}`,prec:O.PREC0},"*":{func:(e,t)=>[e,t].every(d.isNumber)?e*t:`${e}*${t}`,prec:O.PREC1},"/":{func:(e,t)=>[e,t].every(d.isNumber)?e/t:`${e}/${t}`,prec:O.PREC1},"%":{func:(e,t)=>[e,t].every(d.isNumber)?e%t:`${e}%${t}`,prec:O.PREC1}},X={"-":e=>-e},L=class{constructor(t,n=[],s="(),",a=!1){this.src=t;this.hist=n;this.syntax=s;this.alreadyCrashed=a}nextToken(){let t=this.next();return t!==null&&this.unnext(t),t}lastToken(){return this.hist[this.hist.length-1]}unnext(t){this.src=t+this.src,this.hist.pop()}next(){if(this.src=this.src.trimStart(),this.src.length==0)return null;let t=u=>u in G||u in X||this.syntax.includes(u),n=this.src.startsWith('"'),s=this.src.startsWith("'"),a=n||s,o=this.src.indexOf(n?'"':"'",1);if(a&&o>0){let u=this.src.slice(0,o+1);return this.src=this.src.slice(o+1),this.hist.push(u),u}if(t(this.src[0])){let u=this.src[0];return this.src=this.src.slice(1),this.hist.push(u),u}for(let u=0;u<this.src.length;++u)if(t(this.src[u])||this.src[u]==" "){let l=this.src.slice(0,u);return this.src=this.src.slice(u),this.hist.push(l),l}let i=this.src;return this.hist.push(i),this.src="",i}hasNext(){let t=this.next(),n=t!==null;return n&&this.unnext(t),n}spaceAfterToken(){let t=this.next(),n=t!==null;if(n&&this.src){let s=this.src.length-this.src.trimStart().length;if(s>0)return this.unnext(t)," ".repeat(s)}return n&&this.unnext(t),""}},Pe=e=>{let t=e.next();if(t!==null)if(t in X){let n=F(e);return{kind:"unary_op",payload:{op:t,operand:n}}}else if(t==="("){let n=F(e);if(t=e.next(),t===q&&(t=e.next()),t!==")")throw new Error("Expected ')' but got '"+t+"'");return n}else if(t===")"){if(!e.alreadyCrashed)return e.alreadyCrashed=!0,e.unnext(","+q+")"),Pe(e);throw new Error("No primary expression starts with ')'")}else{let n=e.next();if(n==="("){let s=[];if(n=e.next(),n===")")return{kind:"funcall",payload:{name:t,args:s}};if(n===null)throw Error("Unexpected end of input");for(e.unnext(n),s.push(F(e)),n=e.next(),n===q&&(n=e.next());n==",";)s.push(F(e)),n=e.next(),n===q&&(n=e.next());return n===q&&(n=e.next()),n!==")"?{kind:"symbol",payload:{value:t}}:{kind:"funcall",payload:{name:t,args:s}}}else return n!==null&&e.unnext(n),{kind:"symbol",payload:{value:t}}}else throw new Error("Expected primary expression but reached the end of the input")},F=(e,t=O.PREC0)=>{if(t>=O.COUNT_PRECS)return Pe(e);let n=F(e,t+1),s=e.next();if(s!==null)if(s in G&&G[s].prec==t){let a=F(e,t);return{kind:"binary_op",payload:{op:s,lhs:n,rhs:a}}}else e.unnext(s);return n},P=(e,t={},n=[])=>{console.assert(d.isObject(e));let s=(o,i)=>K.topSimilar(i,[...Object.keys(t[o]||{})],u=>u,5).map(u=>u.replace(/[\u00A0-\u9999<>&]/g,l=>"&#"+l.charCodeAt(0)+";")),a=(o,i)=>i>1?V.pluralize(o):V.singularize(o);switch(e.kind){case"symbol":{let i=e.payload.value,u=Number(i);if(isNaN(u)){if(t.vars&&i&&i in t.vars)return t.vars[i];if(i!=null&&i.startsWith("$")){let l=s("vars",i),h=a("variable",l.length),c=l.length>1?"are":"is",b=`The most similar ${h} ${c} ${l.join(", ")}`;n.push("Unknown variable '"+i+"'. "+(l.length>0?b:"")),i in(t.funcs||{})&&n.push("'"+i+"' is defined as a function.")}return i}else return u}case"unary_op":{let o=e.payload,i=o==null?void 0:o.op,u=o==null?void 0:o.operand;if(i&&i in X){if(u===void 0)throw new Error("operand needs to be an object not undefined");return X[i](P(u,t))}throw new Error("Unknown unary operator '"+o.op+"'")}case"binary_op":{let o=e.payload,i=o==null?void 0:o.op,u=o==null?void 0:o.lhs,l=o==null?void 0:o.rhs;if(i&&i in G){if(u===void 0)throw new Error(`lhs operand needs to be an object not undefined: lhs=${u} :: rhs=${l}`);if(l===void 0)throw new Error(`rhs operand needs to be an object not undefined: lhs=${u} :: rhs=${l}`);return G[i].func(P(u,t),P(l,t))}throw new Error("Unknown binary operator '"+i+"'")}case"funcall":{let o=e.payload,i=o.name,u=o.args;if(t.funcs&&i!==void 0&&u!==void 0&&i in t.funcs){let h;return(h=t.funcs)[i].apply(h,u.map(c=>P(c,t)))}if(i!=null&&i.startsWith("$")){let h=s("funcs",i),c=a("function",h.length),b=h.length>1?"are":"is",B=`The most similar ${c} ${b} ${h.join(", ")}`;n.push("Unknown function '"+i+"'. "+(h.length>0?B:"")),i in(t.vars||{})&&n.push("'"+i+"' is defined as a variable.")}let l=u==null?void 0:u.map(h=>{var c;return(c=h==null?void 0:h.payload)==null?void 0:c.value}).map(h=>d.isObject(h)?JSON.stringify(h):h).join(", ");return`${i}(${l||""})`}default:throw new Error("Unexpected AST node '"+e.kind+"'")}};var gt=e=>(d.isString(e)&&(e.startsWith('"')&&e.endsWith('"')||e.startsWith("'")&&e.endsWith("'"))&&(e=e.substring(1,e.length-1)),e),yt=e=>{let t=e==null?void 0:e.funcs;if(t&&d.isObject(t)){let n=R({},t),s={};Object.keys(n).forEach(a=>{s[a]=(...o)=>(o=o.map(gt),n[a](...o))}),e.funcs=s}return e},$t=(e,t={})=>{let n=[],s=[];return{result:e.split(`
`).map((o,i)=>{try{let u=ze(o,t);return n.push(...u.warnings.map(l=>({lineNumber:i+1,message:l}))),u.result}catch(u){if(u.message.toLowerCase().startsWith("no primary expression starts with ')'")||u.message.startsWith("Expected ')' but got '")){let h=o.replace(/(\W)\(([^)]+)\)/g,"$1 <parentheses> $2 </parentheses>");try{let c=ze(h,t);return n.push(...c.warnings.map(b=>({lineNumber:i+1,message:b}))),c.result.replace(/<parentheses> /gi,"(").replace(/ <\/parentheses>/gi,")")}catch(c){}}let l="";u&&(l=u.message,!l&&u.toString&&(l=u.toString())),s.push({lineNumber:i+1,message:l,error:u})}return o}).join(`
`),warnings:n,errors:s}},ze=(e,t={})=>{var i;let n=[],s=yt(R({},t)),a=new L(e),o=[];for(;a.hasNext();){let u=a.spaceAfterToken(),l="",h=F(a),c=h.payload.value,b=[];if(c&&d.isString(c)&&c.startsWith("$")){l=u;let C=c.endsWith("."),m=c.endsWith("!"),_=c.endsWith("("),y=c.endsWith(")"),$=c.endsWith(">"),A=c.endsWith("<");for(;c&&(C||m||_||y||$||A);)c=c.substring(0,c.length-1),C?b.push("."):m?b.push("!"):_?b.push("("):y?b.push(")"):$?b.push(">"):A&&b.push("<"),C=c.endsWith("."),m=c.endsWith("!"),_=c.endsWith("("),y=c.endsWith(")"),$=c.endsWith(">"),A=c.endsWith("<");b.length!==0&&(h.payload.value=c)}let B=h.kind==="funcall",N=h.kind==="symbol",k=P(h,s,n),j=b.join("");o.push(k+j+l);let v=(i=a.lastToken())==null?void 0:i.startsWith("$"),p=o.lastIndexOf(",")-1;a.lastToken()===","&&o[p]===" "&&o.splice(p,1),B&&!["!",".",","].includes(a.nextToken())&&o.push(" "),B||N&&v||o.push(" ")}return{result:o.join("").trim(),warnings:n}},Q=class{constructor(t={includeBuiltIns:!0},n={},s=[],a=[]){this.options=t;this.ctx=n;this.errors=s;this.warnings=a;this.options.includeBuiltIns&&(this.ctx.funcs=R(R({},this.builtinFunctions()),this.ctx.funcs||{}))}builtinFunctions(){let t=r=>Math.abs(r),n=(...r)=>r.map(a).every(f=>f===!0),s=(...r)=>r.map(a).some(f=>f===!0),a=r=>d.isValidBoolean(r)?d.isTrue(r):!!r&&Ee(r),o=r=>parseFloat(r),i=r=>{if(v(r))return`${r}`;if(d.isObject(r))try{r=JSON.stringify(r)}catch(f){let g=[];r=JSON.stringify(r,(x,T)=>{if(typeof T=="object"&&T!==null){if(g.includes(T))return"[Circular]";g.push(T)}return T}).replace(/"\[Circular\]"/g,()=>JSON.stringify("[Circular]"))}return d.isString(r)||(r=r.toString?r.toString():`${r}`),r},u=(r,...f)=>(!d.isString(r)||f.length===0||f.map(i).forEach((g,E)=>{let x=`{${E}}`;for(;r.includes(x);)r=r.replace(x,g)}),r),l=(r,f,g)=>a(r)?f:g,h=r=>parseInt(r),c=(r,...f)=>{let g=ve(r);return f.map(i).some(E=>g===E)},b=r=>c(r,"string"),B=r=>c(r,"number","bigint"),N=r=>c(r,"undefined"),k=r=>c(r,"object"),j=r=>c(r,"boolean"),v=r=>r==null,p=(r,f,g)=>(r=i(r),f=i(f),r.endsWith(f,g)),C=(r,f,g)=>i(r).startsWith(f,g),m=r=>i(r).toLowerCase(),_=r=>i(r).toUpperCase(),y=r=>i(r).length,$=(...r)=>Math.max(...r.map(i).map(o).filter(f=>!isNaN(f))),A=(...r)=>Math.min(...r.map(i).map(o).filter(f=>!isNaN(f))),H=(r,f)=>Math.pow(r,f),W=r=>Math.round(r),J=(r,...f)=>{try{let E=Math[r],x=d.isFunction(E)?E(...f):E;if(x)return x}catch(E){this.errors.push({error:E,message:E.message||`${E}`,lineNumber:NaN})}let g=f.join(", ");return this.warnings.push({lineNumber:NaN,message:`Couldn't resolve Math.${r}${g?"("+g+")":""}`}),`$math('${r}'${g?", "+g:""})`},Me=(...r)=>r.map(i).join(""),Ve=(r,f,g)=>{let E=i(r);return(f===void 0||!d.isNumber(f)||f<0)&&(f=0),(g===void 0||!d.isNumber(f)||g>E.length)&&(g=E.length),E.substring(f,g)},ve=r=>typeof r,qe=(r,...f)=>{let g=r;return f.filter(d.isString).forEach(E=>{let x=E.split(".");g[x[0]]||(x=[E]),x.filter(T=>!!T).forEach(T=>{g&&T&&g[T]&&(g=g[T])})}),g},Ge=(r,...f)=>{let g=r,E=!0;return f.filter(d.isString).forEach(x=>{let T=x.split(".");g[T[0]]||(T=[x]),T.filter(z=>!!z).forEach(z=>{g&&z&&g[z]?g=g[z]:E=!1})}),E},Ee=r=>!i(r).startsWith("$");return{$if:l,$abs:t,$all:n,$any:s,$bool:a,$float:o,$str:i,$format:u,$int:h,$isnil:v,$isinstance:c,$tisstring:b,$tisnumber:B,$tisboolean:j,$tisundefined:N,$tisobject:k,$len:y,$max:$,$min:A,$pow:H,$round:W,$substring:Ve,$type:ve,$math:J,$getattr:qe,$concat:Me,$hasattr:Ge,$isset:Ee,$includes:(r,f)=>{if(r){if(r.includes&&d.isFunction(r.includes))return r.includes(f);if(r.has&&d.isFunction(r.has))return r.has(f)}return!1},$endsWith:p,$startsWith:C,$lower:m,$upper:_,$now:()=>new Date}}fixName(t){return t.startsWith("$")?t:"$"+t}fnExists(t){return t=this.fixName(t),t in(this.ctx.funcs||{})}varExists(t){return t=this.fixName(t),t in(this.ctx.vars||{})}addVar(t,n){t=this.fixName(t),this.ctx.vars=this.ctx.vars||{},this.ctx.vars[t]=n}addFunction(t,n){t=this.fixName(t),this.ctx.funcs=this.ctx.funcs||{},this.ctx.funcs[t]=n}clearWarnings(){this.warnings=[]}clearErrors(){this.errors=[]}parse(t){let n=$t(t,this.ctx||{});return this.errors.push(...n.errors),this.warnings.push(...n.warnings),n}},Gt=new Q({includeBuiltIns:!1}).builtinFunctions,De={SentenceParser:Q};var Ce={};ee(Ce,{Option:()=>$e,Result:()=>be});var bt=e=>d.isError(e,!1),$e=class{},be=class{constructor(t,n,s,a=!1){this.fn=t;this.result=n;this.error=s;this.ran=a}match(t){let n=this.isErr();return this.isOk()&&this.result!==void 0?t.onOk(this.result):n&&this.error!==void 0?t.onError(this.error):t.debug&&t.debug(this.result,this.error),[this.result,this.error]}run(...t){this.ran=!0;try{let n=this.fn(...t);bt(n)?this.error=n:this.result=n}catch(n){this.error=n}return this}isErr(){if(!this.ran)return null;let t=this.error===void 0,n=this.result===void 0;return n&&t?null:!!(n&&!t)}isOk(){if(!this.ran)return null;let t=this.error===void 0;return this.result===void 0&&t?null:!!t}};var Ct=R({check:d,parser:De,inflection:V,utils:M,date:Y,fuzzy:K,array:Re,diff:Ae,std:Ce},Te);return Xe(vt);})();
//# sourceMappingURL=clasico-utils.js.map
