"use strict";var Clasico=(()=>{var K=Object.defineProperty,Ke=Object.defineProperties,Ye=Object.getOwnPropertyDescriptor,Xe=Object.getOwnPropertyDescriptors,Qe=Object.getOwnPropertyNames,xe=Object.getOwnPropertySymbols;var Te=Object.prototype.hasOwnProperty,He=Object.prototype.propertyIsEnumerable;var Ce=(e,t,n)=>t in e?K(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,k=(e,t)=>{for(var n in t||(t={}))Te.call(t,n)&&Ce(e,n,t[n]);if(xe)for(var n of xe(t))He.call(t,n)&&Ce(e,n,t[n]);return e},Y=(e,t)=>Ke(e,Xe(t));var Ee=(e,t)=>{for(var n in t)K(e,n,{get:t[n],enumerable:!0})},et=(e,t,n,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of Qe(t))!Te.call(e,i)&&i!==n&&K(e,i,{get:()=>t[i],enumerable:!(s=Ye(t,i))||s.enumerable});return e};var tt=e=>et(K({},"__esModule",{value:!0}),e);var Ot={};Ee(Ot,{default:()=>Nt});var Re={};var fe={};Ee(fe,{BisectArray:()=>O,ReverseCompareArray:()=>le,ReverseNumberArray:()=>oe,ReverseSortedArray:()=>D,ReverseStringArray:()=>ue,SortedArray:()=>re,SortedCompareArray:()=>pe,SortedNumberArray:()=>ae,SortedStringArray:()=>ce});var nt=e=>{let t=e.getDay();return t===0||t===6},st=(e,t,n)=>e>=t&&e<=n,it=e=>{let t=new Date(e);return isNaN(t.getTime())?null:t},rt=e=>{let t=Math.floor((+new Date-+e)/1e3),n=t/31536e3;return n>1?(n=Math.floor(n),[n,n===1?"year":"years"]):(n=t/2592e3,n>1?(n=Math.floor(n),[n,n===1?"month":"months"]):(n=t/86400,n>1?(n=Math.floor(n),[n,n===1?"day":"days"]):(n=t/3600,n>1?(n=Math.floor(n),[n,n===1?"hour":"hours"]):(n=t/60,n>1?(n=Math.floor(n),[n,n===1?"minute":"minutes"]):(n=Math.floor(t),[n,n===1?"second":"seconds"])))))},I={parse:it,isWeekend:nt,between:st,timeSince:rt};var te=e=>typeof e=="number"||e instanceof Number,ot=e=>typeof e=="bigint"||e instanceof BigInt,j=e=>typeof e=="string"||e instanceof String,ne=e=>typeof e=="boolean"||e instanceof Boolean,se=e=>typeof e=="function"||e instanceof Function,at=e=>M(e)?!1:typeof e=="object",M=e=>e==null,_e=e=>Array.isArray(e)||e instanceof Array||Object.prototype.toString.call(e)==="[object Array]",we=e=>e instanceof Set||Object.prototype.toString.call(e)==="[object Set]",ut=e=>M(e)?!1:se(e[Symbol.iterator]),ct=e=>te(e)?!0:j(e)?!isNaN(e)&&!isNaN(parseFloat(e)):!1,ie=e=>{if(ne(e))return!0;let t=te(e),n=j(e);if(t||n){let s=["true","false",1,0,"1","0",new Boolean(!0),new Boolean(!1),!0,!1];if(s.includes(e))return!0;if(n){e=e.trim();let i=Math.max(...s.map(l=>l.toString().length));if(e.length<=i&&s.includes(e.toLowerCase()))return!0}}return!1},Se=e=>(e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof BigInt||e instanceof Symbol)&&e.valueOf&&se(e.valueOf)?e.valueOf():e,Be=e=>{let t=Se(e);if(e===!0||t===!0)return!0;if(ie(e)){let n=[!0,"true","1",1,new Boolean(!0)];if(n.includes(e))return!0;if(!M(t)){if(n.includes(t))return!0;j(t)&&(e=t)}if(j(e)){let s=e.trim(),i=Math.max(...n.map(l=>l.toString().length));if(s.length<=i&&n.includes(s.toLowerCase()))return!0}}return!1},lt=e=>e===!1||Se(e)===!1?!0:ie(e)?!Be(e):!1,pt=e=>M(e)||j(e)&&typeof e=="string"&&(e=e.trim(),!e)||ne(e)||_e(e)||we(e)?!1:!!I.parse(e),ft=(e,t=!1)=>M(e)?!1:!!(e instanceof Error||t&&e&&e.stack&&e.message),C={isNil:M,isNumber:te,isBigInt:ot,isString:j,isBoolean:ne,isFunction:se,isObject:at,isNumeric:ct,isValidBoolean:ie,isTrue:Be,isFalse:lt,isArray:_e,isSet:we,isIterable:ut,isDate:pt,isError:ft};var O=class extends Array{constructor(n){let s=n.items;super(...s);this.opts=n;this.isValidCmp()?this.sort(this.opts.cmp):this.sort((i,l)=>this.opts.key(i)-this.opts.key(l)),this.opts.asReversed&&this.reverse()}pop(){return this.isReversed()?super.pop():super.shift()}push(...n){for(let s of n){let i=this.binarySearch(s);this.splice(i,0,s)}return this.length}binarySearch(n){let s=0,i=this.length-1;for(;s<=i;){let l=Math.floor((s+i)/2);if(this.shouldSwap(this[l],n))s=l+1;else if(this.shouldSwap(n,this[l]))i=l-1;else return l}return s}shouldSwap(n,s){if(this.opts.cmp&&this.isValidCmp())return this.isReversed()?this.opts.cmp(s,n)<=0:this.opts.cmp(n,s)<=0;let i=this.opts.key(n),l=this.opts.key(s);return this.isReversed()?l-i<=0:i-l<=0}isValidCmp(){return this.opts.cmp&&C.isFunction(this.opts.cmp)}isReversed(){return this.opts.asReversed}},D=class extends O{constructor(t,...n){super({key:t,asReversed:!0,items:n})}},re=class extends O{constructor(t,...n){super({key:t,asReversed:!1,items:n})}},oe=class extends O{constructor(...t){super({key:n=>n,asReversed:!0,items:t})}},ae=class extends O{constructor(...t){super({key:n=>n,asReversed:!1,items:t})}},ue=class extends O{constructor(...t){super({key:()=>0,cmp:(n,s)=>n.localeCompare(s),asReversed:!0,items:t})}},ce=class extends O{constructor(...t){super({key:()=>0,cmp:(n,s)=>n.localeCompare(s),asReversed:!0,items:t})}},le=class extends O{constructor(t,...n){super({key:()=>0,cmp:t,asReversed:!0,items:n})}},pe=class extends O{constructor(t,...n){super({key:()=>0,cmp:t,asReversed:!0,items:n})}};function*ke(...e){let t=e.reduce((n,s)=>{let i=s.length;return i<n?i:n},1/0);for(let n=0;n<t;++n)yield e.map(s=>s[n])}var Ne=Y(k({},fe),{zip:ke});function Oe(e,t,n){function s(c,h,d){let v=new Map;for(let E=h;E<=d;E++){let x=c[E];v.has(x)?(v.get(x).count++,v.get(x).index=E):v.set(x,{count:1,index:E})}return v.forEach((E,x,m)=>{E.count!==1?m.delete(x):m.set(x,E.index)}),v}function i(c,h,d,v,E,x){let m=s(c,h,d),W=s(v,E,x);return m.forEach((ee,z,Z)=>{W.has(z)?Z.set(z,{indexA:ee,indexB:W.get(z)}):Z.delete(z)}),m}function l(c){let h=[];c.forEach((v,E,x)=>{let m=0;for(;h[m]&&h[m][h[m].length-1].indexB<v.indexB;)m++;h[m]||(h[m]=[]),0<m&&(v.prev=h[m-1][h[m-1].length-1]),h[m].push(v)});let d=[];if(0<h.length){let v=h.length-1;for(d=[h[v][h[v].length-1]];d[d.length-1].prev;)d.push(d[d.length-1].prev)}return d.reverse()}let o=[],r=0,g=0,b=[],p=[],f=[],_=[];function u(c,h){h<0?(b.push(e[c]),p.push(o.length),r++):c<0&&(f.push(t[h]),_.push(o.length),g++),o.push({line:0<=c?e[c]:t[h],aIndex:c,bIndex:h})}function y(c,h,d,v){for(;c<=h&&d<=v&&e[c]===t[d];)u(c++,d++);let E=h;for(;c<=h&&d<=v&&e[h]===t[v];)h--,v--;let x=i(e,c,h,t,d,v);if(x.size===0){for(;c<=h;)u(c++,-1);for(;d<=v;)u(-1,d++)}else N(c,h,d,v,x);for(;h<E;)u(++h,++v)}function N(c,h,d,v,E){let x=l(E||i(e,c,h,t,d,v));if(x.length===0)y(c,h,d,v);else{(c<x[0].indexA||d<x[0].indexB)&&y(c,x[0].indexA-1,d,x[0].indexB-1);let m;for(m=0;m<x.length-1;m++)y(x[m].indexA,x[m+1].indexA-1,x[m].indexB,x[m+1].indexB-1);(x[m].indexA<=h||x[m].indexB<=v)&&y(x[m].indexA,h,x[m].indexB,v)}}return N(0,e.length-1,0,t.length-1),n?{lines:o,lineCountDeleted:r,lineCountInserted:g,lineCountMoved:0,aMove:b,aMoveIndex:p,bMove:f,bMoveIndex:_}:{lines:o,lineCountDeleted:r,lineCountInserted:g,lineCountMoved:0}}var Lt=Oe([],[],!0),ht=(e,t)=>{let n=Oe(e.split(`
`),t.split(`
`),!0);return{changes:n.lines.map((i,l)=>{let o="unknown";return i.aIndex>=0&&i.bIndex<0?o="deleted":i.aIndex<0&&i.bIndex>=0?o="inserted":i.aIndex>=0&&i.bIndex>=0&&(o="changed"),{changeType:o,lineNumber:l+1,lineContent:i.line,aIndex:i.aIndex,bIndex:i.bIndex}}),deletedCount:n.lineCountDeleted,insertedCount:n.lineCountInserted,movedCount:n.lineCountInserted,linedMovedFromA:n.aMove||[],linesMovedFromB:n.bMove||[],_diff:n}},Ae={compare:ht};var he=(e,t,n=2)=>{let s=(f,_)=>{f=" ".repeat(_-1)+f.toLowerCase()+" ".repeat(_-1);let u=new Array(f.length-_+1);for(let y=0;y<u.length;y++)u[y]=f.slice(y,y+_);return u};if(!(e!=null&&e.length)||!(t!=null&&t.length))return 0;let i=e.length<t.length?e:t,l=e.length<t.length?t:e,o=s(i,n),r=s(l,n),g=new Set(o),b=r.length,p=0;for(let f of r)g.delete(f)&&p++;return p/b},mt=(e,t,n,s=5,i=.35,l=2)=>{let o=n(e);s<=0&&(s=5);let r=new Map,g=new D(b=>{let p=n(b),f=r.get(p),_=f||he(o,p,l);return f===void 0&&r.set(p,_),_});return t.forEach(b=>{if(he(o,n(b),l)>=i&&(g.push(b),g.length>s)){let f=g.pop();f&&r.delete(n(f))}}),[...g]},X={similarity:he,topSimilar:mt};function gt(e,t=!0){if(t&&!C.isString(e)){if(C.isSet(e)&&(e=Array.from(e)),C.isObject(e))try{e=JSON.stringify(e)}catch(s){let i=[];e=JSON.stringify(e,(o,r)=>{if(typeof r=="object"&&r!==null){if(i.includes(r))return"[Circular]";i.push(r)}return r}).replace(/"\[Circular]"/g,()=>JSON.stringify("[Circular]"))}!C.isString(e)&&e.toString&&(e=e.toString())}if(!C.isString(e))return null;let n=0;for(let s=0;s<e.length;++s){let i=e.charCodeAt(s);n=(n<<5)-n+i,n&=n}return n}function yt(e){return C.isString(e)?e.charAt(0).toUpperCase()+e.slice(1):""}function dt(e,t,n){return new Promise((s,i)=>{let l=0;function o(){e().then(s).catch(r=>{l++,l<t?setTimeout(o,n):i(r)})}o()})}function $t(e){return new Promise(t=>setTimeout(t,e))}var V={hashCode:gt,capitalize:yt,retry:dt,sleep:$t};var me=[[/(quiz)$/i,"$1zes"],[/^(oxen)$/i,"$1"],[/^(ox)$/i,"$1en"],[/(m|l)ice$/i,"$1ice"],[/(m|l)ouse$/i,"$1ice"],[/(passer)s?by$/i,"$1sby"],[/(matr|vert|ind)(?:ix|ex)$/i,"$1ices"],[/(x|ch|ss|sh)$/i,"$1es"],[/([^aeiouy]|qu)y$/i,"$1ies"],[/(hive)$/i,"$1s"],[/([lr])f$/i,"$1ves"],[/([^f])fe$/i,"$1ves"],[/sis$/i,"ses"],[/([ti])a$/i,"$1a"],[/([ti])um$/i,"$1a"],[/(buffal|potat|tomat)o$/i,"$1oes"],[/(bu)s$/i,"$1ses"],[/(alias|status)$/i,"$1es"],[/(octop|vir)i$/i,"$1i"],[/(octop|vir)us$/i,"$1i"],[/^(ax|test)is$/i,"$1es"],[/s$/i,"s"],[/$/i,"s"]],ge=[[/(database)s$/i,"$1"],[/(quiz)zes$/i,"$1"],[/(matr)ices$/i,"$1ix"],[/(vert|ind)ices$/i,"$1ex"],[/(passer)sby$/i,"$1by"],[/^(ox)en/i,"$1"],[/(alias|status)(es)?$/i,"$1"],[/(octop|vir)(us|i)$/i,"$1us"],[/^(a)x[ie]s$/i,"$1xis"],[/(cris|test)(is|es)$/i,"$1is"],[/(shoe)s$/i,"$1"],[/(o)es$/i,"$1"],[/(bus)(es)?$/i,"$1"],[/(m|l)ice$/i,"$1ouse"],[/(x|ch|ss|sh)es$/i,"$1"],[/(m)ovies$/i,"$1ovie"],[/(s)eries$/i,"$1eries"],[/([^aeiouy]|qu)ies$/i,"$1y"],[/([lr])ves$/i,"$1f"],[/(tive)s$/i,"$1"],[/(hive)s$/i,"$1"],[/([^f])ves$/i,"$1fe"],[/(t)he(sis|ses)$/i,"$1hesis"],[/(s)ynop(sis|ses)$/i,"$1ynopsis"],[/(p)rogno(sis|ses)$/i,"$1rognosis"],[/(p)arenthe(sis|ses)$/i,"$1arenthesis"],[/(d)iagno(sis|ses)$/i,"$1iagnosis"],[/(b)a(sis|ses)$/i,"$1asis"],[/(a)naly(sis|ses)$/i,"$1nalysis"],[/([ti])a$/i,"$1um"],[/(n)ews$/i,"$1ews"],[/(ss)$/i,"$1"],[/s$/i,""]],ye=new Set(["equipment","fish","information","jeans","money","rice","series","sheep","species"]),w=(e,t)=>{let n=o=>Array.from(o).map(r=>"["+r+r.toUpperCase()+"]").join(""),s=(o,r,g)=>{o.splice(r,0,[new RegExp(g[0],"i"),g[1]])},i=(o,r)=>{s(me,o,r)},l=(o,r)=>{s(ge,o,r)};e[0].toUpperCase()==t[0].toUpperCase()?(i(0,[`(${e[0]})${e.slice(1)}$`,"$1"+t.slice(1)]),i(0,[`(${t[0]})${t.slice(1)}$`,"$1"+t.slice(1)]),l(0,[`(${t[0]})${t.slice(1)}$`,"$1"+e.slice(1)])):(i(0,[`${e[0].toUpperCase()}${n(e.slice(1))}$`,t[0].toUpperCase()+t.slice(1)]),i(0,[`${e[0].toLowerCase()}${n(e.slice(1))}$`,t[0].toLowerCase()+t.slice(1)]),i(0,[`${t[0].toUpperCase()}${n(t.slice(1))}$`,t[0].toUpperCase()+t.slice(1)]),i(0,[`${t[0].toLowerCase()}${n(t.slice(1))}$`,t[0].toLowerCase()+t.slice(1)]),l(0,[`${t[0].toUpperCase()}${n(t.slice(1))}$`,e[0].toUpperCase()+e.slice(1)]),l(0,[`${t[0].toLowerCase()}${n(t.slice(1))}$`,e[0].toLowerCase()+e.slice(1)]))},bt=(e,t=!0)=>{let n=We(e).replace(/-/," ").replace(/(?:^\w|[A-Z]|\b\w)/g,(i,l)=>l===0?i.toLowerCase():i.toUpperCase()).replace(/\s+/g,"");return t?n.charAt(0).toUpperCase()+n.slice(1):n},We=e=>e.replace(/_/g,"-"),Fe=e=>(e=e.replace(/_id$/i,""),e=e.replace(/_/g," "),e=e.replace(/([a-z\d]*)/g,t=>t.toLowerCase()),e=e.replace(/^\w/,t=>t.toUpperCase()),e),ze=e=>{e=typeof e=="number"?e:parseInt(e);let t=Math.abs(e);if([11,12,13].includes(t%100))return"th";switch(t%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}},vt=e=>e.toString()+ze(e),xt=(e,t="-")=>{let s=je(e).replace(/[^\d\w-]+/gmi,t);if(t!==""){for(;s.startsWith(t);)s=s.slice(t.length);for(;s.endsWith(t);)s=s.slice(0,s.length-t.length)}return s.toLowerCase()},Ie=e=>{let t=/[A-Z]/.test(e.charAt(0)),n=/[A-Za-z]$/.test(e);if(!e||ye.has(e.toLowerCase())||!n)return e;for(let s of me){let i=s[0],l=s[1];if(i.test(e)){let o=e.replace(i,l);return t?V.capitalize(o):o}}return e},Ct=e=>{let t=/[A-Z]/.test(e.charAt(0));for(let n of ye)if(new RegExp(`\\b${n}\\b`,"i").test(e))return e;for(let n of ge){let s=n[0],i=n[1];if(s.test(e)){let l=e.replace(s,i);return t?V.capitalize(l):l}}return e},Tt=e=>Ie(de(e)),Et=e=>Fe(de(e)).split(/\s+/).map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" "),je=e=>e.normalize("NFKD").replace(/[\u0300-\u036f]/g,"").replace(/[^\x00-\x7F]/g,"").trim(),de=e=>{let t=e.replace(/([a-z\d])([A-Z])/g,"$1_$2");return t=t.replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2"),t=t.replace(/-/g,"_"),t.toLowerCase()};w("person","people");w("man","men");w("human","humans");w("child","children");w("sex","sexes");w("move","moves");w("cow","kine");w("zombie","zombies");w("slave","slaves");w("this","this");w("flour","flour");w("milk","milk");w("water","water");w("reserve","reserves");w("gas","gasses");w("bias","biases");w("atlas","atlases");w("goose","geese");w("pasta","pastas");w("slice","slices");w("cactus","cacti");var L={camelize:bt,dasherize:We,humanize:Fe,ordinal:ze,ordinalize:vt,parameterize:xt,pluralize:Ie,singularize:Ct,tableize:Tt,titleize:Et,transliterate:je,underscore:de,UNCOUNTABLES:ye,PLURALS:me,SINGULARS:ge};var q="$B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B",A={0:"PREC0",1:"PREC1",2:"COUNT_PRECS",PREC0:0,PREC1:1,COUNT_PRECS:2};Object.freeze(A);Object.seal(A);var G={"+":{func:(e,t)=>[e,t].every(C.isNumber)?e+t:`${e}+${t}`,prec:A.PREC0},"-":{func:(e,t)=>[e,t].every(C.isNumber)?e-t:`${e}-${t}`,prec:A.PREC0},"*":{func:(e,t)=>[e,t].every(C.isNumber)?e*t:`${e}*${t}`,prec:A.PREC1},"/":{func:(e,t)=>[e,t].every(C.isNumber)?e/t:`${e}/${t}`,prec:A.PREC1},"%":{func:(e,t)=>[e,t].every(C.isNumber)?e%t:`${e}%${t}`,prec:A.PREC1}},Q={"-":e=>-e},H=class{constructor(t,n=[],s="(),",i=!1){this.src=t;this.hist=n;this.syntax=s;this.alreadyCrashed=i}nextToken(){let t=this.next();return t!==null&&this.unnext(t),t}lastToken(){return this.hist[this.hist.length-1]}unnext(t){this.src=t+this.src,this.hist.pop()}next(){if(this.src=this.src.trimStart(),this.src.length==0)return null;let t=r=>r in G||r in Q||this.syntax.includes(r),n=this.src.startsWith('"'),s=this.src.startsWith("'"),i=n||s,l=this.src.indexOf(n?'"':"'",1);if(i&&l>0){let r=this.src.slice(0,l+1);return this.src=this.src.slice(l+1),this.hist.push(r),r}if(t(this.src[0])){let r=this.src[0];return this.src=this.src.slice(1),this.hist.push(r),r}for(let r=0;r<this.src.length;++r)if(t(this.src[r])||this.src[r]==" "){let g=this.src.slice(0,r);return this.src=this.src.slice(r),this.hist.push(g),g}let o=this.src;return this.hist.push(o),this.src="",o}hasNext(){let t=this.next(),n=t!==null;return n&&this.unnext(t),n}spaceAfterToken(){let t=this.next(),n=t!==null;if(n&&this.src){let s=this.src.length-this.src.trimStart().length;if(s>0)return this.unnext(t)," ".repeat(s)}return n&&this.unnext(t),""}},Me=e=>{let t=e.next();if(t!==null)if(t in Q){let n=F(e);return{kind:"unary_op",payload:{op:t,operand:n}}}else if(t==="("){let n=F(e);if(t=e.next(),t===q&&(t=e.next()),t!==")")throw new Error("Expected ')' but got '"+t+"'");return n}else if(t===")"){if(!e.alreadyCrashed)return e.alreadyCrashed=!0,e.unnext(","+q+")"),Me(e);throw new Error("No primary expression starts with ')'")}else{let n=e.next();if(n==="("){let s=[];if(n=e.next(),n===")")return{kind:"funcall",payload:{name:t,args:s}};if(n===null)throw Error("Unexpected end of input");for(e.unnext(n),s.push(F(e)),n=e.next(),n===q&&(n=e.next());n==",";)s.push(F(e)),n=e.next(),n===q&&(n=e.next());return n===q&&(n=e.next()),n!==")"?{kind:"symbol",payload:{value:t}}:{kind:"funcall",payload:{name:t,args:s}}}else return n!==null&&e.unnext(n),{kind:"symbol",payload:{value:t}}}else throw new Error("Expected primary expression but reached the end of the input")},F=(e,t=A.PREC0)=>{if(t>=A.COUNT_PRECS)return Me(e);let n=F(e,t+1),s=e.next();if(s!==null)if(s in G&&G[s].prec==t){let i=F(e,t);return{kind:"binary_op",payload:{op:s,lhs:n,rhs:i}}}else e.unnext(s);return n},P=(e,t={},n=[])=>{console.assert(C.isObject(e));let s=o=>{n.push({timestamp:new Date,message:o})},i=(o,r)=>X.topSimilar(r,[...Object.keys(t[o]||{})],g=>g,5).map(g=>g.replace(/[\u00A0-\u9999<>&]/g,b=>"&#"+b.charCodeAt(0)+";")),l=(o,r)=>r>1?L.pluralize(o):L.singularize(o);switch(e.kind){case"symbol":{let r=e.payload.value,g=Number(r);if(isNaN(g)){if(t.vars&&r&&r in t.vars)return t.vars[r];if(r!=null&&r.startsWith("$")&&!/^\$\d/.test(r)){let b=i("vars",r),p=l("variable",b.length),f=b.length>1?"are":"is",_=` The most similar ${p} ${f} ${b.join(", ")}`;s("Unknown variable '"+r+"'."+(b.length>0?_:"")),r in(t.funcs||{})&&s("'"+r+"' is defined as a function.")}return r}else return g}case"unary_op":{let o=e.payload,r=o==null?void 0:o.op,g=o==null?void 0:o.operand;if(r&&r in Q){if(g===void 0)throw new Error("operand needs to be an object not undefined");return Q[r](P(g,t))}throw new Error("Unknown unary operator '"+o.op+"'")}case"binary_op":{let o=e.payload,r=o==null?void 0:o.op,g=o==null?void 0:o.lhs,b=o==null?void 0:o.rhs;if(r&&r in G){if(g===void 0)throw new Error(`lhs operand needs to be an object not undefined: lhs=${g} :: rhs=${b}`);if(b===void 0)throw new Error(`rhs operand needs to be an object not undefined: lhs=${g} :: rhs=${b}`);return G[r].func(P(g,t),P(b,t))}throw new Error("Unknown binary operator '"+r+"'")}case"funcall":{let o=e.payload,r=o.name,g=o.args;if(t.funcs&&r!==void 0&&g!==void 0&&r in t.funcs){let p;return(p=t.funcs)[r].apply(p,g.map(f=>P(f,t)))}if(r!=null&&r.startsWith("$")&&!/^\$\d/.test(r)){let p=i("funcs",r),f=l("function",p.length),_=p.length>1?"are":"is",u=` The most similar ${f} ${_} ${p.join(", ")}`;s("Unknown function '"+r+"'."+(p.length>0?u:"")),r in(t.vars||{})&&s("'"+r+"' is defined as a variable.")}let b=g==null?void 0:g.map(p=>{var f;return(f=p==null?void 0:p.payload)==null?void 0:f.value}).map(p=>C.isObject(p)?JSON.stringify(p):p).join(", ");return`${r}(${b||""})`}default:throw new Error("Unexpected AST node '"+e.kind+"'")}};var Rt=e=>(C.isString(e)&&(e.startsWith('"')&&e.endsWith('"')||e.startsWith("'")&&e.endsWith("'"))&&(e=e.substring(1,e.length-1)),e),_t=e=>{let t=e==null?void 0:e.funcs;if(t&&C.isObject(t)){let n=k({},t),s={};Object.keys(n).forEach(i=>{s[i]=(...l)=>(l=l.map(Rt),n[i](...l))}),e.funcs=s}return e},Ue=(e,t={})=>{let n=[];return{result:e.split(`
`).map((i,l)=>{try{let o=Pe(i,t);return n.push(...o.warnings.map(r=>k({lineNumber:l+1,level:"WARN"},r))),o.result}catch(o){if(o.message.toLowerCase().startsWith("no primary expression starts with ')'")||o.message.startsWith("Expected ')' but got '")){let g=i.replace(/(\W)\(([^)]+)\)/g,"$1 <parentheses> $2 </parentheses>");try{let b=Pe(g,t);return n.push(...b.warnings.map(p=>k({lineNumber:l+1,level:"WARN"},p))),b.result.replace(/<parentheses> /gi,"(").replace(/ <\/parentheses>/gi,")")}catch(b){}}let r="";o&&(r=o.message,!r&&o.toString&&(r=o.toString())),r||(r=`${o}`),n.push({lineNumber:l+1,level:"ERROR",message:r,error:o,timestamp:new Date})}return i}).join(`
`),logs:n}},Pe=(e,t={})=>{var o;let n=[],s=_t(k({},t)),i=new H(e),l=[];for(;i.hasNext();){let r=i.spaceAfterToken(),g="",b=F(i),p=b.payload.value,f=[];if(p&&C.isString(p)&&p.startsWith("$")){g=r;let d=p.endsWith("."),v=p.endsWith("!"),E=p.endsWith("("),x=p.endsWith(")"),m=p.endsWith(">"),W=p.endsWith("<");for(;p&&(d||v||E||x||m||W);)p=p.substring(0,p.length-1),d?f.push("."):v?f.push("!"):E?f.push("("):x?f.push(")"):m?f.push(">"):W&&f.push("<"),d=p.endsWith("."),v=p.endsWith("!"),E=p.endsWith("("),x=p.endsWith(")"),m=p.endsWith(">"),W=p.endsWith("<");f.length!==0&&(b.payload.value=p)}let _=b.kind==="funcall",u=b.kind==="symbol",y=P(b,s,n),N=f.join("");l.push(y+N+g);let c=(o=i.lastToken())==null?void 0:o.startsWith("$"),h=l.lastIndexOf(",")-1;i.lastToken()===","&&l[h]===" "&&l.splice(h,1),_&&!["!",".",","].includes(i.nextToken())&&l.push(" "),_||u&&c||l.push(" ")}return{result:l.join("").trim(),warnings:n}},J=class{constructor(t={includeBuiltIns:!0},n={},s=[]){this.options=t;this.ctx=n;this.logs=s;this.options.includeBuiltIns&&(this.ctx.funcs=k(k({},this.builtinFunctions()),this.ctx.funcs||{}))}builtinFunctions(){let t=a=>Math.abs(a),n=(...a)=>a.map(i).every($=>$===!0),s=(...a)=>a.map(i).some($=>$===!0),i=a=>C.isValidBoolean(a)?C.isTrue(a):!!a&&ve(a),l=a=>parseFloat(a),o=a=>{if(c(a))return`${a}`;if(C.isObject(a))try{a=JSON.stringify(a)}catch($){let T=[];a=JSON.stringify(a,(B,S)=>{if(typeof S=="bigint")return S.toString();if(typeof S=="object"&&S!==null){if(T.includes(S))return"[Circular]";T.push(S)}return S}).replace(/"\[Circular\]"/g,()=>JSON.stringify("[Circular]"))}return C.isString(a)||(a=a.toString?a.toString():`${a}`),a},r=(a,...$)=>(!C.isString(a)||$.length===0||$.map(o).forEach((T,R)=>{let B=`{${R}}`;for(;a.includes(B);)a=a.replace(B,T)}),a),g=(a,$,T)=>i(a)?$:T,b=a=>parseInt(a),p=(a,...$)=>{let T=be(a);return $.map(o).some(R=>T===R)},f=a=>p(a,"string"),_=a=>p(a,"number","bigint"),u=a=>p(a,"undefined"),y=a=>p(a,"object"),N=a=>p(a,"boolean"),c=a=>a==null,h=(a,$,T)=>(a=o(a),$=o($),a.endsWith($,T)),d=(a,$,T)=>o(a).startsWith($,T),v=a=>o(a).toLowerCase(),E=a=>o(a).toUpperCase(),x=a=>o(a).length,m=(...a)=>Math.max(...a.map(o).map(l).filter($=>!isNaN($))),W=(...a)=>Math.min(...a.map(o).map(l).filter($=>!isNaN($))),ee=(a,$)=>Math.pow(a,$),z=a=>Math.round(a),Z=(a,...$)=>{try{let R=Math[a],B=C.isFunction(R)?R(...$):R;if(B)return B}catch(R){this.logs.push({level:"ERROR",error:R,message:R.message||`${R}`,lineNumber:NaN,timestamp:new Date})}let T=$.join(", ");return this.logs.push({level:"WARN",lineNumber:NaN,message:`Couldn't resolve Math.${a}${T?"("+T+")":""}`,timestamp:new Date}),`$math('${a}'${T?", "+T:""})`},qe=(...a)=>a.map(o).join(""),Ge=(a,$,T)=>{let R=o(a);return($===void 0||!C.isNumber($)||$<0)&&($=0),(T===void 0||!C.isNumber($)||T>R.length)&&(T=R.length),R.substring($,T)},be=a=>typeof a,Je=(a,...$)=>{let T=a;return $.filter(C.isString).forEach(R=>{let B=R.split(".");T[B[0]]||(B=[R]),B.filter(S=>!!S).forEach(S=>{T&&S&&T[S]&&(T=T[S])})}),T},Ze=(a,...$)=>{let T=a,R=!0;return $.filter(C.isString).forEach(B=>{let S=B.split(".");T[S[0]]||(S=[B]),S.filter(U=>!!U).forEach(U=>{T&&U&&T[U]?T=T[U]:R=!1})}),R},ve=a=>!o(a).startsWith("$");return{$if:g,$abs:t,$all:n,$any:s,$bool:i,$float:l,$str:o,$format:r,$int:b,$isnil:c,$isinstance:p,$tisstring:f,$tisnumber:_,$tisboolean:N,$tisundefined:u,$tisobject:y,$len:x,$max:m,$min:W,$pow:ee,$round:z,$substring:Ge,$type:be,$math:Z,$getattr:Je,$concat:qe,$hasattr:Ze,$isset:ve,$includes:(a,$)=>{if(a){if(a.includes&&C.isFunction(a.includes))return a.includes($);if(a.has&&C.isFunction(a.has))return a.has($)}return!1},$endsWith:h,$startsWith:d,$lower:v,$upper:E,$now:()=>new Date}}fixName(t){return t.startsWith("$")?t:"$"+t}fnExists(t){return t=this.fixName(t),t in(this.ctx.funcs||{})}varExists(t){return t=this.fixName(t),t in(this.ctx.vars||{})}addVar(t,n){t=this.fixName(t),this.ctx.vars=this.ctx.vars||{},this.ctx.vars[t]=n}addFunction(t,n){t=this.fixName(t),this.ctx.funcs=this.ctx.funcs||{},this.ctx.funcs[t]=n}clearLogs(){this.logs=[]}parse(t){let n=Ue(t,this.ctx||{});return this.logs.push(...n.logs),n}},wt=e=>{if(C.isNumeric(e))return parseFloat(e);if(C.isValidBoolean(e))return C.isTrue(e);if(I.parse(e)!==null)return new Date(e);if(e==="undefined")return;if(e==="null")return null;try{return JSON.parse(e)}catch(t){return e}},St=(e,t)=>{let n=Ue(e,t||{});return{result:wt(n.result),logs:n.logs}},on=new J({includeBuiltIns:!1}).builtinFunctions,$e={SentenceParser:J,TemplateParser:J,lval:St};var Bt=(()=>{let e={english:new Set(["a","about","above","after","again","against","ain","all","am","an","and","any","are","aren","aren't","as","at","be","because","been","before","being","below","between","both","but","by","can","couldn","couldn't","d","did","didn","didn't","do","does","doesn","doesn't","doing","don","don't","down","during","each","few","for","from","further","had","hadn","hadn't","has","hasn","hasn't","have","haven","haven't","having","he","her","here","hers","herself","him","himself","his","how","i","if","in","into","is","isn","isn't","it","it's","its","itself","just","ll","m","ma","me","mightn","mightn't","more","most","mustn","mustn't","my","myself","needn","needn't","no","nor","not","now","o","of","off","on","once","only","or","other","our","ours","ourselves","out","over","own","re","s","same","shan","shan't","she","she's","should","should've","shouldn","shouldn't","so","some","such","t","than","that","that'll","the","their","theirs","them","themselves","then","there","these","they","this","those","through","to","too","under","until","up","ve","very","was","wasn","wasn't","we","were","weren","weren't","what","when","where","which","while","who","whom","why","will","with","won","won't","wouldn","wouldn't","y","you","you'd","you'll","you're","you've","your","yours","yourself","yourselves"])};function t(s,i="english"){return e[i].has(s.replace(/[^\w\d']/gi,"").toLowerCase())}function n(s,i="english"){return s.trim().split(/\s+/g).filter(r=>!t(r,i)).join(" ")}return{isStopWord:t,removeStopWords:n}})(),De=Bt;function kt(){let e={ational:"ate",tional:"tion",enci:"ence",anci:"ance",izer:"ize",bli:"ble",alli:"al",entli:"ent",eli:"e",ousli:"ous",ization:"ize",ation:"ate",ator:"ate",alism:"al",iveness:"ive",fulness:"ful",ousness:"ous",aliti:"al",iviti:"ive",biliti:"ble",logi:"log"},t={icate:"ic",ative:"",alize:"al",iciti:"ic",ical:"ic",ful:"",ness:""},n="[^aeiou]",s="[aeiouy]",i=n+"[^aeiouy]*",l=s+"[aeiou]*",o="^("+i+")?"+l+i,r="^("+i+")?"+l+i+"("+l+")?$",g="^("+i+")?"+l+i+l+i,b="^("+i+")?"+s;function p(u,y){return u.exec(y)}function f(u,y){return u.test(y)}function _(u){let y,N,c,h,d,v;if(u.length<3)return u;let E=u.slice(),x=u.substring(0,1);if(x==="y"&&(u=x.toUpperCase()+u.substring(1)),c=/^(.+?)(ss|i)es?$/,h=/^(.+?)([^s])s$/,f(c,u)?(d=/ies$/,f(d,u)?u=u.replace(c,"$1y"):u=u.replace(c,"$1$2")):f(h,u)&&(u=u.replace(h,"$1$2")),c=/^(.+?)eed$/,h=/^(.+?)(ed|ing)$/,d=/^(.+?)(ly)$/,v=/^(.+?)([^s]*s)$/,f(c,u)){let m=p(c,u);m&&(c=new RegExp(o),f(c,m[1])&&(c=/.$/,u=u.replace(c,"")))}else if(f(h,u)){let m=p(h,u);m&&(y=m[1],h=new RegExp(b),f(h,y)&&(u=y,h=/(at|bl|iz)$/,d=new RegExp("([^aeiouylsz])\\1$"),v=new RegExp("^"+i+s+"[^aeiouwxy]$"),f(h,u)?u=u+"e":f(d,u)?(c=/.$/,u=u.replace(c,"")):f(v,u)&&(u=u+"e")))}else if(f(d,u)){let m=p(d,u);m&&(y=m[1],c=new RegExp(b),f(c,y)&&(u=y))}if(c=/^(.+?)y$/,h=/(yed|ies)$/,f(c,u)&&!f(h,E)){let m=p(c,u);m&&(y=m[1],c=new RegExp(b),f(c,y)&&(u=y+"i"))}if(c=/^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$/,f(c,u)){let m=p(c,u);m&&(y=m[1],N=m[2],c=new RegExp(o),f(c,y)&&(u=y+e[N]))}if(c=/^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/,f(c,u)){let m=p(c,u);m&&(y=m[1],N=m[2],c=new RegExp(o),f(c,y)&&(u=y+t[N]))}if(c=/^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/,h=/^(.+?)([st])(ion)$/,f(c,u)){let m=p(c,u);m&&(y=m[1],c=new RegExp(g),f(c,y)&&(u=y))}else if(f(h,u)){let m=p(h,u);m&&(y=m[1]+m[2],h=new RegExp(g),f(h,y)&&(u=y))}if(c=/^(.+?)e$/,f(c,u)){let m=p(c,u);m&&(y=m[1],c=new RegExp(g),h=new RegExp(r),d=new RegExp("^"+i+s+"[^aeiouwxy]$"),(f(c,y)||f(h,y)&&!f(d,y))&&(u=y))}return c=/ll$/,h=new RegExp(g),f(c,u)&&f(h,u)&&(c=/.$/,u=u.replace(c,"")),x==="y"&&(u="y"+u.substring(1)),u}return _}var Ve=kt();var Le=Y(k({},De),{stemmer:Ve});var Nt=k({check:C,parser:$e,template:$e,inflection:L,utils:V,date:I,fuzzy:X,array:Ne,diff:Ae,nlp:Le},Re);return tt(Ot);})();
//# sourceMappingURL=clasico-utils.js.map
