"use strict";var Clasico=(()=>{var K=Object.defineProperty,Je=Object.defineProperties,Ze=Object.getOwnPropertyDescriptor,Ke=Object.getOwnPropertyDescriptors,Ye=Object.getOwnPropertyNames,we=Object.getOwnPropertySymbols;var Ce=Object.prototype.hasOwnProperty,Xe=Object.prototype.propertyIsEnumerable;var ve=(e,t,n)=>t in e?K(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,N=(e,t)=>{for(var n in t||(t={}))Ce.call(t,n)&&ve(e,n,t[n]);if(we)for(var n of we(t))Xe.call(t,n)&&ve(e,n,t[n]);return e},Te=(e,t)=>Je(e,Ke(t));var xe=(e,t)=>{for(var n in t)K(e,n,{get:t[n],enumerable:!0})},Qe=(e,t,n,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of Ye(t))!Ce.call(e,o)&&o!==n&&K(e,o,{get:()=>t[o],enumerable:!(s=Ze(t,o))||s.enumerable});return e};var He=e=>Qe(K({},"__esModule",{value:!0}),e);var Et={};xe(Et,{default:()=>Bt});var _e={};var pe={};xe(pe,{BisectArray:()=>R,ReverseCompareArray:()=>ce,ReverseNumberArray:()=>ie,ReverseSortedArray:()=>z,ReverseStringArray:()=>ae,SortedArray:()=>re,SortedCompareArray:()=>le,SortedNumberArray:()=>oe,SortedStringArray:()=>ue});var et=e=>{let t=e.getDay();return t===0||t===6},tt=(e,t,n)=>e>=t&&e<=n,nt=e=>{let t=new Date(e);return isNaN(t.getTime())?null:t},st=e=>{let t=Math.floor((+new Date-+e)/1e3),n=t/31536e3;return n>1?(n=Math.floor(n),[n,n===1?"year":"years"]):(n=t/2592e3,n>1?(n=Math.floor(n),[n,n===1?"month":"months"]):(n=t/86400,n>1?(n=Math.floor(n),[n,n===1?"day":"days"]):(n=t/3600,n>1?(n=Math.floor(n),[n,n===1?"hour":"hours"]):(n=t/60,n>1?(n=Math.floor(n),[n,n===1?"minute":"minutes"]):(n=Math.floor(t),[n,n===1?"second":"seconds"])))))},M={parse:nt,isWeekend:et,between:tt,timeSince:st};var ee=e=>typeof e=="number"||e instanceof Number,rt=e=>typeof e=="bigint"||e instanceof BigInt,I=e=>typeof e=="string"||e instanceof String,te=e=>typeof e=="boolean"||e instanceof Boolean,ne=e=>typeof e=="function"||e instanceof Function,it=e=>U(e)?!1:typeof e=="object",U=e=>e==null,Be=e=>Array.isArray(e)||e instanceof Array||Object.prototype.toString.call(e)==="[object Array]",Ee=e=>e instanceof Set||Object.prototype.toString.call(e)==="[object Set]",ot=e=>U(e)?!1:ne(e[Symbol.iterator]),at=e=>ee(e)?!0:I(e)?!isNaN(e)&&!isNaN(parseFloat(e)):!1,se=e=>{if(te(e))return!0;let t=ee(e),n=I(e);if(t||n){let s=["true","false",1,0,"1","0",new Boolean(!0),new Boolean(!1),!0,!1];if(s.includes(e))return!0;if(n){e=e.trim();let o=Math.max(...s.map(u=>u.toString().length));if(e.length<=o&&s.includes(e.toLowerCase()))return!0}}return!1},ke=e=>(e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof BigInt||e instanceof Symbol)&&e.valueOf&&ne(e.valueOf)?e.valueOf():e,Se=e=>{let t=ke(e);if(e===!0||t===!0)return!0;if(se(e)){let n=[!0,"true","1",1,new Boolean(!0)];if(n.includes(e))return!0;if(!U(t)){if(n.includes(t))return!0;I(t)&&(e=t)}if(I(e)){let s=e.trim(),o=Math.max(...n.map(u=>u.toString().length));if(s.length<=o&&n.includes(s.toLowerCase()))return!0}}return!1},ut=e=>e===!1||ke(e)===!1?!0:se(e)?!Se(e):!1,ct=e=>U(e)||I(e)&&typeof e=="string"&&(e=e.trim(),!e)||te(e)||Be(e)||Ee(e)?!1:!!M.parse(e),lt=(e,t=!1)=>U(e)?!1:!!(e instanceof Error||t&&e&&e.stack&&e.message),h={isNil:U,isNumber:ee,isBigInt:rt,isString:I,isBoolean:te,isFunction:ne,isObject:it,isNumeric:at,isValidBoolean:se,isTrue:Se,isFalse:ut,isArray:Be,isSet:Ee,isIterable:ot,isDate:ct,isError:lt};var R=class extends Array{constructor(n){let s=n.items;super(...s);this.opts=n;this.isValidCmp()?this.sort(this.opts.cmp):this.sort((o,u)=>this.opts.key(o)-this.opts.key(u)),this.opts.asReversed&&this.reverse()}pop(){return this.isReversed()?super.pop():super.shift()}push(...n){for(let s of n){let o=this.binarySearch(s);this.splice(o,0,s)}return this.length}binarySearch(n){let s=0,o=this.length-1;for(;s<=o;){let u=Math.floor((s+o)/2);if(this.shouldSwap(this[u],n))s=u+1;else if(this.shouldSwap(n,this[u]))o=u-1;else return u}return s}shouldSwap(n,s){if(this.opts.cmp&&this.isValidCmp())return this.isReversed()?this.opts.cmp(s,n)<=0:this.opts.cmp(n,s)<=0;let o=this.opts.key(n),u=this.opts.key(s);return this.isReversed()?u-o<=0:o-u<=0}isValidCmp(){return this.opts.cmp&&h.isFunction(this.opts.cmp)}isReversed(){return this.opts.asReversed}},z=class extends R{constructor(t,...n){super({key:t,asReversed:!0,items:n})}},re=class extends R{constructor(t,...n){super({key:t,asReversed:!1,items:n})}},ie=class extends R{constructor(...t){super({key:n=>n,asReversed:!0,items:t})}},oe=class extends R{constructor(...t){super({key:n=>n,asReversed:!1,items:t})}},ae=class extends R{constructor(...t){super({key:()=>0,cmp:(n,s)=>n.localeCompare(s),asReversed:!0,items:t})}},ue=class extends R{constructor(...t){super({key:()=>0,cmp:(n,s)=>n.localeCompare(s),asReversed:!0,items:t})}},ce=class extends R{constructor(t,...n){super({key:()=>0,cmp:t,asReversed:!0,items:n})}},le=class extends R{constructor(t,...n){super({key:()=>0,cmp:t,asReversed:!0,items:n})}};function*Ne(...e){let t=e.reduce((n,s)=>{let o=s.length;return o<n?o:n},1/0);for(let n=0;n<t;++n)yield e.map(s=>s[n])}var Re=Te(N({},pe),{zip:Ne});function Oe(e,t,n){function s(v,p,w){let g=new Map;for(let T=p;T<=w;T++){let $=v[T];g.has($)?(g.get($).count++,g.get($).index=T):g.set($,{count:1,index:T})}return g.forEach((T,$,b)=>{T.count!==1?b.delete($):b.set($,T.index)}),g}function o(v,p,w,g,T,$){let b=s(v,p,w),A=s(g,T,$);return b.forEach((H,j,Z)=>{A.has(j)?Z.set(j,{indexA:H,indexB:A.get(j)}):Z.delete(j)}),b}function u(v){let p=[];v.forEach((g,T,$)=>{let b=0;for(;p[b]&&p[b][p[b].length-1].indexB<g.indexB;)b++;p[b]||(p[b]=[]),0<b&&(g.prev=p[b-1][p[b-1].length-1]),p[b].push(g)});let w=[];if(0<p.length){let g=p.length-1;for(w=[p[g][p[g].length-1]];w[w.length-1].prev;)w.push(w[w.length-1].prev)}return w.reverse()}let a=[],r=0,l=0,d=[],c=[],m=[],_=[];function E(v,p){p<0?(d.push(e[v]),c.push(a.length),r++):v<0&&(m.push(t[p]),_.push(a.length),l++),a.push({line:0<=v?e[v]:t[p],aIndex:v,bIndex:p})}function k(v,p,w,g){for(;v<=p&&w<=g&&e[v]===t[w];)E(v++,w++);let T=p;for(;v<=p&&w<=g&&e[p]===t[g];)p--,g--;let $=o(e,v,p,t,w,g);if($.size===0){for(;v<=p;)E(v++,-1);for(;w<=g;)E(-1,w++)}else F(v,p,w,g,$);for(;p<T;)E(++p,++g)}function F(v,p,w,g,T){let $=u(T||o(e,v,p,t,w,g));if($.length===0)k(v,p,w,g);else{(v<$[0].indexA||w<$[0].indexB)&&k(v,$[0].indexA-1,w,$[0].indexB-1);let b;for(b=0;b<$.length-1;b++)k($[b].indexA,$[b+1].indexA-1,$[b].indexB,$[b+1].indexB-1);($[b].indexA<=p||$[b].indexB<=g)&&k($[b].indexA,p,$[b].indexB,g)}}return F(0,e.length-1,0,t.length-1),n?{lines:a,lineCountDeleted:r,lineCountInserted:l,lineCountMoved:0,aMove:d,aMoveIndex:c,bMove:m,bMoveIndex:_}:{lines:a,lineCountDeleted:r,lineCountInserted:l,lineCountMoved:0}}var Ut=Oe([],[],!0),pt=(e,t)=>{let n=Oe(e.split(`
`),t.split(`
`),!0);return{changes:n.lines.map((o,u)=>{let a="unknown";return o.aIndex>=0&&o.bIndex<0?a="deleted":o.aIndex<0&&o.bIndex>=0?a="inserted":o.aIndex>=0&&o.bIndex>=0&&(a="changed"),{changeType:a,lineNumber:u+1,lineContent:o.line,aIndex:o.aIndex,bIndex:o.bIndex}}),deletedCount:n.lineCountDeleted,insertedCount:n.lineCountInserted,movedCount:n.lineCountInserted,linedMovedFromA:n.aMove||[],linesMovedFromB:n.bMove||[],_diff:n}},Ae={compare:pt};var fe=(e,t,n=2)=>{let s=(m,_)=>{m=" ".repeat(_-1)+m.toLowerCase()+" ".repeat(_-1);let E=new Array(m.length-_+1);for(let k=0;k<E.length;k++)E[k]=m.slice(k,k+_);return E};if(!(e!=null&&e.length)||!(t!=null&&t.length))return 0;let o=e.length<t.length?e:t,u=e.length<t.length?t:e,a=s(o,n),r=s(u,n),l=new Set(a),d=r.length,c=0;for(let m of r)l.delete(m)&&c++;return c/d},ft=(e,t,n,s=5,o=.35,u=2)=>{let a=n(e);s<=0&&(s=5);let r=new Map,l=new z(d=>{let c=n(d),m=r.get(c),_=m||fe(a,c,u);return m===void 0&&r.set(c,_),_});return t.forEach(d=>{if(fe(a,n(d),u)>=o&&(l.push(d),l.length>s)){let m=l.pop();m&&r.delete(n(m))}}),[...l]},Y={similarity:fe,topSimilar:ft};var ht=(e,t=!0)=>{if(t&&!h.isString(e)){if(h.isSet(e)&&(e=Array.from(e)),h.isObject(e))try{e=JSON.stringify(e)}catch(s){let o=[];e=JSON.stringify(e,(a,r)=>{if(typeof r=="object"&&r!==null){if(o.includes(r))return"[Circular]";o.push(r)}return r}).replace(/"\[Circular\]"/g,()=>JSON.stringify("[Circular]"))}!h.isString(e)&&e.toString&&(e=e.toString())}if(!h.isString(e))return null;let n=0;for(let s=0;s<e.length;++s){let o=e.charCodeAt(s);n=(n<<5)-n+o,n&=n}return n},dt=e=>h.isString(e)?e.charAt(0).toUpperCase()+e.slice(1):"",V={hashCode:ht,capitalize:dt};var he=[[/(quiz)$/i,"$1zes"],[/^(oxen)$/i,"$1"],[/^(ox)$/i,"$1en"],[/(m|l)ice$/i,"$1ice"],[/(m|l)ouse$/i,"$1ice"],[/(passer)s?by$/i,"$1sby"],[/(matr|vert|ind)(?:ix|ex)$/i,"$1ices"],[/(x|ch|ss|sh)$/i,"$1es"],[/([^aeiouy]|qu)y$/i,"$1ies"],[/(hive)$/i,"$1s"],[/([lr])f$/i,"$1ves"],[/([^f])fe$/i,"$1ves"],[/sis$/i,"ses"],[/([ti])a$/i,"$1a"],[/([ti])um$/i,"$1a"],[/(buffal|potat|tomat)o$/i,"$1oes"],[/(bu)s$/i,"$1ses"],[/(alias|status)$/i,"$1es"],[/(octop|vir)i$/i,"$1i"],[/(octop|vir)us$/i,"$1i"],[/^(ax|test)is$/i,"$1es"],[/s$/i,"s"],[/$/i,"s"]],de=[[/(database)s$/i,"$1"],[/(quiz)zes$/i,"$1"],[/(matr)ices$/i,"$1ix"],[/(vert|ind)ices$/i,"$1ex"],[/(passer)sby$/i,"$1by"],[/^(ox)en/i,"$1"],[/(alias|status)(es)?$/i,"$1"],[/(octop|vir)(us|i)$/i,"$1us"],[/^(a)x[ie]s$/i,"$1xis"],[/(cris|test)(is|es)$/i,"$1is"],[/(shoe)s$/i,"$1"],[/(o)es$/i,"$1"],[/(bus)(es)?$/i,"$1"],[/(m|l)ice$/i,"$1ouse"],[/(x|ch|ss|sh)es$/i,"$1"],[/(m)ovies$/i,"$1ovie"],[/(s)eries$/i,"$1eries"],[/([^aeiouy]|qu)ies$/i,"$1y"],[/([lr])ves$/i,"$1f"],[/(tive)s$/i,"$1"],[/(hive)s$/i,"$1"],[/([^f])ves$/i,"$1fe"],[/(t)he(sis|ses)$/i,"$1hesis"],[/(s)ynop(sis|ses)$/i,"$1ynopsis"],[/(p)rogno(sis|ses)$/i,"$1rognosis"],[/(p)arenthe(sis|ses)$/i,"$1arenthesis"],[/(d)iagno(sis|ses)$/i,"$1iagnosis"],[/(b)a(sis|ses)$/i,"$1asis"],[/(a)naly(sis|ses)$/i,"$1nalysis"],[/([ti])a$/i,"$1um"],[/(n)ews$/i,"$1ews"],[/(ss)$/i,"$1"],[/s$/i,""]],me=new Set(["equipment","fish","information","jeans","money","rice","series","sheep","species"]),x=(e,t)=>{let n=a=>Array.from(a).map(r=>"["+r+r.toUpperCase()+"]").join(""),s=(a,r,l)=>{a.splice(r,0,[new RegExp(l[0],"i"),l[1]])},o=(a,r)=>{s(he,a,r)},u=(a,r)=>{s(de,a,r)};e[0].toUpperCase()==t[0].toUpperCase()?(o(0,[`(${e[0]})${e.slice(1)}$`,"$1"+t.slice(1)]),o(0,[`(${t[0]})${t.slice(1)}$`,"$1"+t.slice(1)]),u(0,[`(${t[0]})${t.slice(1)}$`,"$1"+e.slice(1)])):(o(0,[`${e[0].toUpperCase()}${n(e.slice(1))}$`,t[0].toUpperCase()+t.slice(1)]),o(0,[`${e[0].toLowerCase()}${n(e.slice(1))}$`,t[0].toLowerCase()+t.slice(1)]),o(0,[`${t[0].toUpperCase()}${n(t.slice(1))}$`,t[0].toUpperCase()+t.slice(1)]),o(0,[`${t[0].toLowerCase()}${n(t.slice(1))}$`,t[0].toLowerCase()+t.slice(1)]),u(0,[`${t[0].toUpperCase()}${n(t.slice(1))}$`,e[0].toUpperCase()+e.slice(1)]),u(0,[`${t[0].toLowerCase()}${n(t.slice(1))}$`,e[0].toLowerCase()+e.slice(1)]))},mt=(e,t=!0)=>{let n=We(e).replace(/-/," ").replace(/(?:^\w|[A-Z]|\b\w)/g,(o,u)=>u===0?o.toLowerCase():o.toUpperCase()).replace(/\s+/g,"");return t?n.charAt(0).toUpperCase()+n.slice(1):n},We=e=>e.replace(/_/g,"-"),Fe=e=>(e=e.replace(/_id$/i,""),e=e.replace(/_/g," "),e=e.replace(/([a-z\d]*)/g,t=>t.toLowerCase()),e=e.replace(/^\w/,t=>t.toUpperCase()),e),je=e=>{e=typeof e=="number"?e:parseInt(e);let t=Math.abs(e);if([11,12,13].includes(t%100))return"th";switch(t%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}},gt=e=>e.toString()+je(e),yt=(e,t="-")=>{let s=Ie(e).replace(/[^\d\w-]+/gmi,t);if(t!==""){for(;s.startsWith(t);)s=s.slice(t.length);for(;s.endsWith(t);)s=s.slice(0,s.length-t.length)}return s.toLowerCase()},Me=e=>{let t=/[A-Z]/.test(e.charAt(0)),n=/[A-Za-z]$/.test(e);if(!e||me.has(e.toLowerCase())||!n)return e;for(let s of he){let o=s[0],u=s[1];if(o.test(e)){let a=e.replace(o,u);return t?V.capitalize(a):a}}return e},$t=e=>{let t=/[A-Z]/.test(e.charAt(0));for(let n of me)if(new RegExp(`\\b${n}\\b`,"i").test(e))return e;for(let n of de){let s=n[0],o=n[1];if(s.test(e)){let u=e.replace(s,o);return t?V.capitalize(u):u}}return e},bt=e=>Me(ge(e)),wt=e=>Fe(ge(e)).split(/\s+/).map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" "),Ie=e=>e.normalize("NFKD").replace(/[\u0300-\u036f]/g,"").replace(/[^\x00-\x7F]/g,"").trim(),ge=e=>{let t=e.replace(/([a-z\d])([A-Z])/g,"$1_$2");return t=t.replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2"),t=t.replace(/-/g,"_"),t.toLowerCase()};x("person","people");x("man","men");x("human","humans");x("child","children");x("sex","sexes");x("move","moves");x("cow","kine");x("zombie","zombies");x("slave","slaves");x("this","this");x("flour","flour");x("milk","milk");x("water","water");x("reserve","reserves");x("gas","gasses");x("bias","biases");x("atlas","atlases");x("goose","geese");x("pasta","pastas");x("slice","slices");x("cactus","cacti");var L={camelize:mt,dasherize:We,humanize:Fe,ordinal:je,ordinalize:gt,parameterize:yt,pluralize:Me,singularize:$t,tableize:bt,titleize:wt,transliterate:Ie,underscore:ge,UNCOUNTABLES:me,PLURALS:he,SINGULARS:de};var q="$B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B_B",O={0:"PREC0",1:"PREC1",2:"COUNT_PRECS",PREC0:0,PREC1:1,COUNT_PRECS:2};Object.freeze(O);Object.seal(O);var G={"+":{func:(e,t)=>[e,t].every(h.isNumber)?e+t:`${e}+${t}`,prec:O.PREC0},"-":{func:(e,t)=>[e,t].every(h.isNumber)?e-t:`${e}-${t}`,prec:O.PREC0},"*":{func:(e,t)=>[e,t].every(h.isNumber)?e*t:`${e}*${t}`,prec:O.PREC1},"/":{func:(e,t)=>[e,t].every(h.isNumber)?e/t:`${e}/${t}`,prec:O.PREC1},"%":{func:(e,t)=>[e,t].every(h.isNumber)?e%t:`${e}%${t}`,prec:O.PREC1}},X={"-":e=>-e},Q=class{constructor(t,n=[],s="(),",o=!1){this.src=t;this.hist=n;this.syntax=s;this.alreadyCrashed=o}nextToken(){let t=this.next();return t!==null&&this.unnext(t),t}lastToken(){return this.hist[this.hist.length-1]}unnext(t){this.src=t+this.src,this.hist.pop()}next(){if(this.src=this.src.trimStart(),this.src.length==0)return null;let t=r=>r in G||r in X||this.syntax.includes(r),n=this.src.startsWith('"'),s=this.src.startsWith("'"),o=n||s,u=this.src.indexOf(n?'"':"'",1);if(o&&u>0){let r=this.src.slice(0,u+1);return this.src=this.src.slice(u+1),this.hist.push(r),r}if(t(this.src[0])){let r=this.src[0];return this.src=this.src.slice(1),this.hist.push(r),r}for(let r=0;r<this.src.length;++r)if(t(this.src[r])||this.src[r]==" "){let l=this.src.slice(0,r);return this.src=this.src.slice(r),this.hist.push(l),l}let a=this.src;return this.hist.push(a),this.src="",a}hasNext(){let t=this.next(),n=t!==null;return n&&this.unnext(t),n}spaceAfterToken(){let t=this.next(),n=t!==null;if(n&&this.src){let s=this.src.length-this.src.trimStart().length;if(s>0)return this.unnext(t)," ".repeat(s)}return n&&this.unnext(t),""}},Ue=e=>{let t=e.next();if(t!==null)if(t in X){let n=W(e);return{kind:"unary_op",payload:{op:t,operand:n}}}else if(t==="("){let n=W(e);if(t=e.next(),t===q&&(t=e.next()),t!==")")throw new Error("Expected ')' but got '"+t+"'");return n}else if(t===")"){if(!e.alreadyCrashed)return e.alreadyCrashed=!0,e.unnext(","+q+")"),Ue(e);throw new Error("No primary expression starts with ')'")}else{let n=e.next();if(n==="("){let s=[];if(n=e.next(),n===")")return{kind:"funcall",payload:{name:t,args:s}};if(n===null)throw Error("Unexpected end of input");for(e.unnext(n),s.push(W(e)),n=e.next(),n===q&&(n=e.next());n==",";)s.push(W(e)),n=e.next(),n===q&&(n=e.next());return n===q&&(n=e.next()),n!==")"?{kind:"symbol",payload:{value:t}}:{kind:"funcall",payload:{name:t,args:s}}}else return n!==null&&e.unnext(n),{kind:"symbol",payload:{value:t}}}else throw new Error("Expected primary expression but reached the end of the input")},W=(e,t=O.PREC0)=>{if(t>=O.COUNT_PRECS)return Ue(e);let n=W(e,t+1),s=e.next();if(s!==null)if(s in G&&G[s].prec==t){let o=W(e,t);return{kind:"binary_op",payload:{op:s,lhs:n,rhs:o}}}else e.unnext(s);return n},D=(e,t={},n=[])=>{console.assert(h.isObject(e));let s=a=>{n.push({timestamp:new Date,message:a})},o=(a,r)=>Y.topSimilar(r,[...Object.keys(t[a]||{})],l=>l,5).map(l=>l.replace(/[\u00A0-\u9999<>&]/g,d=>"&#"+d.charCodeAt(0)+";")),u=(a,r)=>r>1?L.pluralize(a):L.singularize(a);switch(e.kind){case"symbol":{let r=e.payload.value,l=Number(r);if(isNaN(l)){if(t.vars&&r&&r in t.vars)return t.vars[r];if(r!=null&&r.startsWith("$")&&!/^\$\d/.test(r)){let d=o("vars",r),c=u("variable",d.length),m=d.length>1?"are":"is",_=` The most similar ${c} ${m} ${d.join(", ")}`;s("Unknown variable '"+r+"'."+(d.length>0?_:"")),r in(t.funcs||{})&&s("'"+r+"' is defined as a function.")}return r}else return l}case"unary_op":{let a=e.payload,r=a==null?void 0:a.op,l=a==null?void 0:a.operand;if(r&&r in X){if(l===void 0)throw new Error("operand needs to be an object not undefined");return X[r](D(l,t))}throw new Error("Unknown unary operator '"+a.op+"'")}case"binary_op":{let a=e.payload,r=a==null?void 0:a.op,l=a==null?void 0:a.lhs,d=a==null?void 0:a.rhs;if(r&&r in G){if(l===void 0)throw new Error(`lhs operand needs to be an object not undefined: lhs=${l} :: rhs=${d}`);if(d===void 0)throw new Error(`rhs operand needs to be an object not undefined: lhs=${l} :: rhs=${d}`);return G[r].func(D(l,t),D(d,t))}throw new Error("Unknown binary operator '"+r+"'")}case"funcall":{let a=e.payload,r=a.name,l=a.args;if(t.funcs&&r!==void 0&&l!==void 0&&r in t.funcs){let c;return(c=t.funcs)[r].apply(c,l.map(m=>D(m,t)))}if(r!=null&&r.startsWith("$")&&!/^\$\d/.test(r)){let c=o("funcs",r),m=u("function",c.length),_=c.length>1?"are":"is",E=` The most similar ${m} ${_} ${c.join(", ")}`;s("Unknown function '"+r+"'."+(c.length>0?E:"")),r in(t.vars||{})&&s("'"+r+"' is defined as a variable.")}let d=l==null?void 0:l.map(c=>{var m;return(m=c==null?void 0:c.payload)==null?void 0:m.value}).map(c=>h.isObject(c)?JSON.stringify(c):c).join(", ");return`${r}(${d||""})`}default:throw new Error("Unexpected AST node '"+e.kind+"'")}};var vt=e=>(h.isString(e)&&(e.startsWith('"')&&e.endsWith('"')||e.startsWith("'")&&e.endsWith("'"))&&(e=e.substring(1,e.length-1)),e),Ct=e=>{let t=e==null?void 0:e.funcs;if(t&&h.isObject(t)){let n=N({},t),s={};Object.keys(n).forEach(o=>{s[o]=(...u)=>(u=u.map(vt),n[o](...u))}),e.funcs=s}return e},Pe=(e,t={})=>{let n=[];return{result:e.split(`
`).map((o,u)=>{try{let a=De(o,t);return n.push(...a.warnings.map(r=>N({lineNumber:u+1,level:"WARN"},r))),a.result}catch(a){if(a.message.toLowerCase().startsWith("no primary expression starts with ')'")||a.message.startsWith("Expected ')' but got '")){let l=o.replace(/(\W)\(([^)]+)\)/g,"$1 <parentheses> $2 </parentheses>");try{let d=De(l,t);return n.push(...d.warnings.map(c=>N({lineNumber:u+1,level:"WARN"},c))),d.result.replace(/<parentheses> /gi,"(").replace(/ <\/parentheses>/gi,")")}catch(d){}}let r="";a&&(r=a.message,!r&&a.toString&&(r=a.toString())),r||(r=`${a}`),n.push({lineNumber:u+1,level:"ERROR",message:r,error:a,timestamp:new Date})}return o}).join(`
`),logs:n}},De=(e,t={})=>{var a;let n=[],s=Ct(N({},t)),o=new Q(e),u=[];for(;o.hasNext();){let r=o.spaceAfterToken(),l="",d=W(o),c=d.payload.value,m=[];if(c&&h.isString(c)&&c.startsWith("$")){l=r;let w=c.endsWith("."),g=c.endsWith("!"),T=c.endsWith("("),$=c.endsWith(")"),b=c.endsWith(">"),A=c.endsWith("<");for(;c&&(w||g||T||$||b||A);)c=c.substring(0,c.length-1),w?m.push("."):g?m.push("!"):T?m.push("("):$?m.push(")"):b?m.push(">"):A&&m.push("<"),w=c.endsWith("."),g=c.endsWith("!"),T=c.endsWith("("),$=c.endsWith(")"),b=c.endsWith(">"),A=c.endsWith("<");m.length!==0&&(d.payload.value=c)}let _=d.kind==="funcall",E=d.kind==="symbol",k=D(d,s,n),F=m.join("");u.push(k+F+l);let v=(a=o.lastToken())==null?void 0:a.startsWith("$"),p=u.lastIndexOf(",")-1;o.lastToken()===","&&u[p]===" "&&u.splice(p,1),_&&!["!",".",","].includes(o.nextToken())&&u.push(" "),_||E&&v||u.push(" ")}return{result:u.join("").trim(),warnings:n}},J=class{constructor(t={includeBuiltIns:!0},n={},s=[]){this.options=t;this.ctx=n;this.logs=s;this.options.includeBuiltIns&&(this.ctx.funcs=N(N({},this.builtinFunctions()),this.ctx.funcs||{}))}builtinFunctions(){let t=i=>Math.abs(i),n=(...i)=>i.map(o).every(f=>f===!0),s=(...i)=>i.map(o).some(f=>f===!0),o=i=>h.isValidBoolean(i)?h.isTrue(i):!!i&&be(i),u=i=>parseFloat(i),a=i=>{if(v(i))return`${i}`;if(h.isObject(i))try{i=JSON.stringify(i)}catch(f){let y=[];i=JSON.stringify(i,(S,B)=>{if(typeof B=="bigint")return B.toString();if(typeof B=="object"&&B!==null){if(y.includes(B))return"[Circular]";y.push(B)}return B}).replace(/"\[Circular\]"/g,()=>JSON.stringify("[Circular]"))}return h.isString(i)||(i=i.toString?i.toString():`${i}`),i},r=(i,...f)=>(!h.isString(i)||f.length===0||f.map(a).forEach((y,C)=>{let S=`{${C}}`;for(;i.includes(S);)i=i.replace(S,y)}),i),l=(i,f,y)=>o(i)?f:y,d=i=>parseInt(i),c=(i,...f)=>{let y=$e(i);return f.map(a).some(C=>y===C)},m=i=>c(i,"string"),_=i=>c(i,"number","bigint"),E=i=>c(i,"undefined"),k=i=>c(i,"object"),F=i=>c(i,"boolean"),v=i=>i==null,p=(i,f,y)=>(i=a(i),f=a(f),i.endsWith(f,y)),w=(i,f,y)=>a(i).startsWith(f,y),g=i=>a(i).toLowerCase(),T=i=>a(i).toUpperCase(),$=i=>a(i).length,b=(...i)=>Math.max(...i.map(a).map(u).filter(f=>!isNaN(f))),A=(...i)=>Math.min(...i.map(a).map(u).filter(f=>!isNaN(f))),H=(i,f)=>Math.pow(i,f),j=i=>Math.round(i),Z=(i,...f)=>{try{let C=Math[i],S=h.isFunction(C)?C(...f):C;if(S)return S}catch(C){this.logs.push({level:"ERROR",error:C,message:C.message||`${C}`,lineNumber:NaN,timestamp:new Date})}let y=f.join(", ");return this.logs.push({level:"WARN",lineNumber:NaN,message:`Couldn't resolve Math.${i}${y?"("+y+")":""}`,timestamp:new Date}),`$math('${i}'${y?", "+y:""})`},Ve=(...i)=>i.map(a).join(""),Le=(i,f,y)=>{let C=a(i);return(f===void 0||!h.isNumber(f)||f<0)&&(f=0),(y===void 0||!h.isNumber(f)||y>C.length)&&(y=C.length),C.substring(f,y)},$e=i=>typeof i,qe=(i,...f)=>{let y=i;return f.filter(h.isString).forEach(C=>{let S=C.split(".");y[S[0]]||(S=[C]),S.filter(B=>!!B).forEach(B=>{y&&B&&y[B]&&(y=y[B])})}),y},Ge=(i,...f)=>{let y=i,C=!0;return f.filter(h.isString).forEach(S=>{let B=S.split(".");y[B[0]]||(B=[S]),B.filter(P=>!!P).forEach(P=>{y&&P&&y[P]?y=y[P]:C=!1})}),C},be=i=>!a(i).startsWith("$");return{$if:l,$abs:t,$all:n,$any:s,$bool:o,$float:u,$str:a,$format:r,$int:d,$isnil:v,$isinstance:c,$tisstring:m,$tisnumber:_,$tisboolean:F,$tisundefined:E,$tisobject:k,$len:$,$max:b,$min:A,$pow:H,$round:j,$substring:Le,$type:$e,$math:Z,$getattr:qe,$concat:Ve,$hasattr:Ge,$isset:be,$includes:(i,f)=>{if(i){if(i.includes&&h.isFunction(i.includes))return i.includes(f);if(i.has&&h.isFunction(i.has))return i.has(f)}return!1},$endsWith:p,$startsWith:w,$lower:g,$upper:T,$now:()=>new Date}}fixName(t){return t.startsWith("$")?t:"$"+t}fnExists(t){return t=this.fixName(t),t in(this.ctx.funcs||{})}varExists(t){return t=this.fixName(t),t in(this.ctx.vars||{})}addVar(t,n){t=this.fixName(t),this.ctx.vars=this.ctx.vars||{},this.ctx.vars[t]=n}addFunction(t,n){t=this.fixName(t),this.ctx.funcs=this.ctx.funcs||{},this.ctx.funcs[t]=n}clearLogs(){this.logs=[]}parse(t){let n=Pe(t,this.ctx||{});return this.logs.push(...n.logs),n}},Tt=e=>{if(h.isNumeric(e))return parseFloat(e);if(h.isValidBoolean(e))return h.isTrue(e);if(M.parse(e)!==null)return new Date(e);if(e==="undefined")return;if(e==="null")return null;try{return JSON.parse(e)}catch(t){return e}},xt=(e,t)=>{let n=Pe(e,t||{});return{result:Tt(n.result),logs:n.logs}},en=new J({includeBuiltIns:!1}).builtinFunctions,ye={SentenceParser:J,TemplateParser:J,lval:xt};var _t=(()=>{let e={english:new Set(["a","about","above","after","again","against","ain","all","am","an","and","any","are","aren","aren't","as","at","be","because","been","before","being","below","between","both","but","by","can","couldn","couldn't","d","did","didn","didn't","do","does","doesn","doesn't","doing","don","don't","down","during","each","few","for","from","further","had","hadn","hadn't","has","hasn","hasn't","have","haven","haven't","having","he","her","here","hers","herself","him","himself","his","how","i","if","in","into","is","isn","isn't","it","it's","its","itself","just","ll","m","ma","me","mightn","mightn't","more","most","mustn","mustn't","my","myself","needn","needn't","no","nor","not","now","o","of","off","on","once","only","or","other","our","ours","ourselves","out","over","own","re","s","same","shan","shan't","she","she's","should","should've","shouldn","shouldn't","so","some","such","t","than","that","that'll","the","their","theirs","them","themselves","then","there","these","they","this","those","through","to","too","under","until","up","ve","very","was","wasn","wasn't","we","were","weren","weren't","what","when","where","which","while","who","whom","why","will","with","won","won't","wouldn","wouldn't","y","you","you'd","you'll","you're","you've","your","yours","yourself","yourselves"])};function t(s,o="english"){return e[o].has(s.replace(/[^\w\d']/gi,"").toLowerCase())}function n(s,o="english"){return s.trim().split(/\s+/g).filter(r=>!t(r,o)).join(" ")}return{isStopWord:t,removeStopWords:n}})(),ze=N({},_t);var Bt=N({check:h,parser:ye,template:ye,inflection:L,utils:V,date:M,fuzzy:Y,array:Re,diff:Ae,nlp:ze},_e);return He(Et);})();
//# sourceMappingURL=clasico-utils.js.map
